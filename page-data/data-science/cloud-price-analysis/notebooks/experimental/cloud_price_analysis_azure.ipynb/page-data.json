{"componentChunkName":"component---src-templates-jupyter-notebook-js","path":"/data-science/cloud-price-analysis/notebooks/experimental/cloud_price_analysis_azure.ipynb","result":{"data":{"site":{"siteMetadata":{"title":"Operate First"}},"jupyterNotebook":{"id":"492a4d39-dcbe-52d3-bea2-71de9b7e2e78 >>> JupyterNotebook","html":"<div class=\"notebook-render\"><div class=\"sc-ifAKCX zMCZx\"><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><h3>Analysis of Azure Pricing details</h3>\n<p>This notebook will analyze service name = &quot;Virtual Machines&quot;\nsource JSON file <a href=\"https://prices.azure.com/api/retail/prices?api-version=2021-10-01-preview&amp;meterRegion=%E2%80%99primary%E2%80%99\">https://prices.azure.com/api/retail/prices?api-version=2021-10-01-preview&amp;meterRegion=%E2%80%99primary%E2%80%99</a></p></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[1]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#0000ff\">import</span> pandas <span class=\"token\" style=\"color:#0000ff\">as</span> pd\n<span class=\"token\" style=\"color:#0000ff\">import</span> requests</code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><h4>Access the API end point for Vitual Machine and store JSON file at location ../data/raw/</h4></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[2]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\">params <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&quot;filter&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;serviceName eq Virtual Machines&quot;</span><span class=\"token\" style=\"color:#393A34\">}</span>\nr <span class=\"token\" style=\"color:#393A34\">=</span> requests<span class=\"token\" style=\"color:#393A34\">.</span>get<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;https://prices.azure.com/api/retail/prices&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span> params<span class=\"token\" style=\"color:#393A34\">=</span>params<span class=\"token\" style=\"color:#393A34\">)</span>\n<span class=\"token\" style=\"color:#0000ff\">with</span> <span class=\"token builtin\">open</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;../../data/raw/azure_vm.json&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&quot;w&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span> <span class=\"token\" style=\"color:#0000ff\">as</span> fd<span class=\"token\" style=\"color:#393A34\">:</span>\n    fd<span class=\"token\" style=\"color:#393A34\">.</span>write<span class=\"token\" style=\"color:#393A34\">(</span>r<span class=\"token\" style=\"color:#393A34\">.</span>text<span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[3]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\">df <span class=\"token\" style=\"color:#393A34\">=</span> pd<span class=\"token\" style=\"color:#393A34\">.</span>read_json<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;../../data/raw/azure_vm.json&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span>\ndf<span class=\"token\" style=\"color:#393A34\">.</span>head<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><div><div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>BillingCurrency</th>\n      <th>CustomerEntityId</th>\n      <th>CustomerEntityType</th>\n      <th>Items</th>\n      <th>NextPageLink</th>\n      <th>Count</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>USD</td>\n      <td>Default</td>\n      <td>Retail</td>\n      <td>{'currencyCode': 'USD', 'tierMinimumUnits': 0....</td>\n      <td>https://prices.azure.com:443/api/retail/prices...</td>\n      <td>100</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>USD</td>\n      <td>Default</td>\n      <td>Retail</td>\n      <td>{'currencyCode': 'USD', 'tierMinimumUnits': 0....</td>\n      <td>https://prices.azure.com:443/api/retail/prices...</td>\n      <td>100</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>USD</td>\n      <td>Default</td>\n      <td>Retail</td>\n      <td>{'currencyCode': 'USD', 'tierMinimumUnits': 0....</td>\n      <td>https://prices.azure.com:443/api/retail/prices...</td>\n      <td>100</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>USD</td>\n      <td>Default</td>\n      <td>Retail</td>\n      <td>{'currencyCode': 'USD', 'tierMinimumUnits': 0....</td>\n      <td>https://prices.azure.com:443/api/retail/prices...</td>\n      <td>100</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>USD</td>\n      <td>Default</td>\n      <td>Retail</td>\n      <td>{'currencyCode': 'USD', 'tierMinimumUnits': 0....</td>\n      <td>https://prices.azure.com:443/api/retail/prices...</td>\n      <td>100</td>\n    </tr>\n  </tbody>\n</table>\n</div></div></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><h4>Understand shape of data</h4></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[4]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#0000ff\">print</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;Shape of the data\\n\\n&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span> df<span class=\"token\" style=\"color:#393A34\">.</span>shape<span class=\"token\" style=\"color:#393A34\">)</span>\n<span class=\"token\" style=\"color:#0000ff\">print</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;\\n\\n&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span>\n<span class=\"token\" style=\"color:#0000ff\">print</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;Is null?\\n\\n&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span> df<span class=\"token\" style=\"color:#393A34\">.</span>isnull<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span>\n<span class=\"token\" style=\"color:#0000ff\">print</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;\\n\\n&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span>\n<span class=\"token\" style=\"color:#0000ff\">print</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;Columnwise Datatype\\n\\n&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span> df<span class=\"token\" style=\"color:#393A34\">.</span>dtypes<span class=\"token\" style=\"color:#393A34\">)</span>\ndf<span class=\"token\" style=\"color:#393A34\">.</span>describe<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><code class=\"nteract-display-area-stdout\"><span>Shape of the data\n\n (100, 6)\n\n\n\nIs null?\n\n BillingCurrency       0\nCustomerEntityId      0\nCustomerEntityType    0\nItems                 0\nNextPageLink          0\nCount                 0\ndtype: int64\n\n\n\nColumnwise Datatype\n\n BillingCurrency       object\nCustomerEntityId      object\nCustomerEntityType    object\nItems                 object\nNextPageLink          object\nCount                  int64\ndtype: object\n</span></code><div><div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Count</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>count</th>\n      <td>100.0</td>\n    </tr>\n    <tr>\n      <th>mean</th>\n      <td>100.0</td>\n    </tr>\n    <tr>\n      <th>std</th>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>min</th>\n      <td>100.0</td>\n    </tr>\n    <tr>\n      <th>25%</th>\n      <td>100.0</td>\n    </tr>\n    <tr>\n      <th>50%</th>\n      <td>100.0</td>\n    </tr>\n    <tr>\n      <th>75%</th>\n      <td>100.0</td>\n    </tr>\n    <tr>\n      <th>max</th>\n      <td>100.0</td>\n    </tr>\n  </tbody>\n</table>\n</div></div></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><h4>Split data into multiple components, create series out of dataframes, List &quot;Items&quot; is carrying actual data items</h4></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[5]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\">df_items <span class=\"token\" style=\"color:#393A34\">=</span> df<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&quot;Items&quot;</span><span class=\"token\" style=\"color:#393A34\">]</span>\ndf_items <span class=\"token\" style=\"color:#393A34\">=</span> df_items<span class=\"token\" style=\"color:#393A34\">.</span>fillna<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;NA&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span>\ndf_items</code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><pre><code><span>0     {&#x27;currencyCode&#x27;: &#x27;USD&#x27;, &#x27;tierMinimumUnits&#x27;: 0....\n1     {&#x27;currencyCode&#x27;: &#x27;USD&#x27;, &#x27;tierMinimumUnits&#x27;: 0....\n2     {&#x27;currencyCode&#x27;: &#x27;USD&#x27;, &#x27;tierMinimumUnits&#x27;: 0....\n3     {&#x27;currencyCode&#x27;: &#x27;USD&#x27;, &#x27;tierMinimumUnits&#x27;: 0....\n4     {&#x27;currencyCode&#x27;: &#x27;USD&#x27;, &#x27;tierMinimumUnits&#x27;: 0....\n                            ...                        \n95    {&#x27;currencyCode&#x27;: &#x27;USD&#x27;, &#x27;tierMinimumUnits&#x27;: 0....\n96    {&#x27;currencyCode&#x27;: &#x27;USD&#x27;, &#x27;tierMinimumUnits&#x27;: 0....\n97    {&#x27;currencyCode&#x27;: &#x27;USD&#x27;, &#x27;tierMinimumUnits&#x27;: 0....\n98    {&#x27;currencyCode&#x27;: &#x27;USD&#x27;, &#x27;tierMinimumUnits&#x27;: 0....\n99    {&#x27;currencyCode&#x27;: &#x27;USD&#x27;, &#x27;tierMinimumUnits&#x27;: 0....\nName: Items, Length: 100, dtype: object</span></code></pre></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><h4>Some times JSON file is missing reservationTerm or sometimes carry the values are 1 Year, 3 Years or onDemand</h4>\n<p>Below piece of code will determine if reservationTime key exists if not insert key with default value as onDemand</p></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[6]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\">df_items_2 <span class=\"token\" style=\"color:#393A34\">=</span> pd<span class=\"token\" style=\"color:#393A34\">.</span>DataFrame<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span>\n\n<span class=\"token\" style=\"color:#0000ff\">for</span> data <span class=\"token\" style=\"color:#0000ff\">in</span> df_items<span class=\"token\" style=\"color:#393A34\">:</span>\n    df_dictionary <span class=\"token\" style=\"color:#393A34\">=</span> pd<span class=\"token\" style=\"color:#393A34\">.</span>DataFrame<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">[</span>data<span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">)</span>\n    <span class=\"token\" style=\"color:#0000ff\">if</span> <span class=\"token\" style=\"color:#A31515\">&quot;reservationTerm&quot;</span> <span class=\"token\" style=\"color:#0000ff\">in</span> data<span class=\"token\" style=\"color:#393A34\">:</span>\n        df_items_2 <span class=\"token\" style=\"color:#393A34\">=</span> pd<span class=\"token\" style=\"color:#393A34\">.</span>concat<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">[</span>df_items_2<span class=\"token\" style=\"color:#393A34\">,</span> df_dictionary<span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span> ignore_index<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">True</span><span class=\"token\" style=\"color:#393A34\">)</span>\n    <span class=\"token\" style=\"color:#0000ff\">else</span><span class=\"token\" style=\"color:#393A34\">:</span>\n        data<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&quot;reservationTerm&quot;</span><span class=\"token\" style=\"color:#393A34\">]</span> <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#A31515\">&quot;OnDemand&quot;</span>\n        df_items_2 <span class=\"token\" style=\"color:#393A34\">=</span> pd<span class=\"token\" style=\"color:#393A34\">.</span>concat<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">[</span>df_items_2<span class=\"token\" style=\"color:#393A34\">,</span> df_dictionary<span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span> ignore_index<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">True</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[7]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\">df_items_2 <span class=\"token\" style=\"color:#393A34\">=</span> df_items_2<span class=\"token\" style=\"color:#393A34\">.</span>fillna<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;NA&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span>\ndf_items_2</code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><div><div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>currencyCode</th>\n      <th>tierMinimumUnits</th>\n      <th>retailPrice</th>\n      <th>unitPrice</th>\n      <th>armRegionName</th>\n      <th>location</th>\n      <th>effectiveStartDate</th>\n      <th>effectiveEndDate</th>\n      <th>meterId</th>\n      <th>meterName</th>\n      <th>...</th>\n      <th>productName</th>\n      <th>skuName</th>\n      <th>serviceName</th>\n      <th>serviceId</th>\n      <th>serviceFamily</th>\n      <th>unitOfMeasure</th>\n      <th>type</th>\n      <th>isPrimaryMeterRegion</th>\n      <th>armSkuName</th>\n      <th>reservationTerm</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>USD</td>\n      <td>0.0</td>\n      <td>0.262752</td>\n      <td>0.262752</td>\n      <td>southindia</td>\n      <td>IN South</td>\n      <td>2022-03-01T00:00:00Z</td>\n      <td>2022-03-31T23:59:00Z</td>\n      <td>000009d0-057f-5f2b-b7e9-9e26add324a8</td>\n      <td>D14/DS14 Spot</td>\n      <td>...</td>\n      <td>Virtual Machines D Series Windows</td>\n      <td>D14 Spot</td>\n      <td>Virtual Machines</td>\n      <td>DZH313Z7MMC8</td>\n      <td>Compute</td>\n      <td>1 Hour</td>\n      <td>DevTestConsumption</td>\n      <td>True</td>\n      <td>Standard_D14</td>\n      <td>NA</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>USD</td>\n      <td>0.0</td>\n      <td>0.542506</td>\n      <td>0.542506</td>\n      <td>southindia</td>\n      <td>IN South</td>\n      <td>2022-03-01T00:00:00Z</td>\n      <td>2022-03-31T23:59:00Z</td>\n      <td>000009d0-057f-5f2b-b7e9-9e26add324a8</td>\n      <td>D14/DS14 Spot</td>\n      <td>...</td>\n      <td>Virtual Machines D Series Windows</td>\n      <td>D14 Spot</td>\n      <td>Virtual Machines</td>\n      <td>DZH313Z7MMC8</td>\n      <td>Compute</td>\n      <td>1 Hour</td>\n      <td>Consumption</td>\n      <td>True</td>\n      <td>Standard_D14</td>\n      <td>NA</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>USD</td>\n      <td>0.0</td>\n      <td>0.865075</td>\n      <td>0.865075</td>\n      <td>eastasia</td>\n      <td>AP East</td>\n      <td>2022-03-01T00:00:00Z</td>\n      <td>2022-03-31T23:59:00Z</td>\n      <td>00014e7d-fff9-54dd-962e-4e992887ad3c</td>\n      <td>D64s v5 Spot</td>\n      <td>...</td>\n      <td>Virtual Machines Dsv5 Series Windows</td>\n      <td>Standard_D64s_v5 Spot</td>\n      <td>Virtual Machines</td>\n      <td>DZH313Z7MMC8</td>\n      <td>Compute</td>\n      <td>1 Hour</td>\n      <td>DevTestConsumption</td>\n      <td>True</td>\n      <td>Standard_D64s_v5</td>\n      <td>NA</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>USD</td>\n      <td>0.0</td>\n      <td>1.468006</td>\n      <td>1.468006</td>\n      <td>eastasia</td>\n      <td>AP East</td>\n      <td>2022-03-01T00:00:00Z</td>\n      <td>2022-03-31T23:59:00Z</td>\n      <td>00014e7d-fff9-54dd-962e-4e992887ad3c</td>\n      <td>D64s v5 Spot</td>\n      <td>...</td>\n      <td>Virtual Machines Dsv5 Series Windows</td>\n      <td>Standard_D64s_v5 Spot</td>\n      <td>Virtual Machines</td>\n      <td>DZH313Z7MMC8</td>\n      <td>Compute</td>\n      <td>1 Hour</td>\n      <td>Consumption</td>\n      <td>True</td>\n      <td>Standard_D64s_v5</td>\n      <td>NA</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>USD</td>\n      <td>0.0</td>\n      <td>10.560000</td>\n      <td>10.560000</td>\n      <td>uksouth</td>\n      <td>UK South</td>\n      <td>2018-11-01T00:00:00Z</td>\n      <td>NA</td>\n      <td>0001d427-82df-4d83-8ab2-b60768527e08</td>\n      <td>E10 Disks</td>\n      <td>...</td>\n      <td>Standard SSD Managed Disks</td>\n      <td>E10 LRS</td>\n      <td>Storage</td>\n      <td>DZH317F1HKN0</td>\n      <td>Storage</td>\n      <td>1/Month</td>\n      <td>Consumption</td>\n      <td>True</td>\n      <td></td>\n      <td>NA</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>95</th>\n      <td>USD</td>\n      <td>0.0</td>\n      <td>0.212000</td>\n      <td>0.212000</td>\n      <td>westcentralus</td>\n      <td>US West Central</td>\n      <td>2021-11-01T00:00:00Z</td>\n      <td>NA</td>\n      <td>00172462-4604-5a25-b1d4-f057577d68e0</td>\n      <td>E4ds v5 Low Priority</td>\n      <td>...</td>\n      <td>Virtual Machines Edsv5 Series Windows</td>\n      <td>E4ds v5 Low Priority</td>\n      <td>Virtual Machines</td>\n      <td>DZH313Z7MMC8</td>\n      <td>Compute</td>\n      <td>1 Hour</td>\n      <td>Consumption</td>\n      <td>True</td>\n      <td>Standard_E4ds_v5</td>\n      <td>NA</td>\n    </tr>\n    <tr>\n      <th>96</th>\n      <td>USD</td>\n      <td>0.0</td>\n      <td>0.069100</td>\n      <td>0.069100</td>\n      <td>westcentralus</td>\n      <td>US West Central</td>\n      <td>2021-11-01T00:00:00Z</td>\n      <td>NA</td>\n      <td>00172462-4604-5a25-b1d4-f057577d68e0</td>\n      <td>E4-2ds v5 Low Priority</td>\n      <td>...</td>\n      <td>Virtual Machines Edsv5 Series Windows</td>\n      <td>E4-2ds v5 Low Priority</td>\n      <td>Virtual Machines</td>\n      <td>DZH313Z7MMC8</td>\n      <td>Compute</td>\n      <td>1 Hour</td>\n      <td>DevTestConsumption</td>\n      <td>False</td>\n      <td>Standard_E4-2ds_v5</td>\n      <td>NA</td>\n    </tr>\n    <tr>\n      <th>97</th>\n      <td>USD</td>\n      <td>0.0</td>\n      <td>0.212000</td>\n      <td>0.212000</td>\n      <td>westcentralus</td>\n      <td>US West Central</td>\n      <td>2021-11-01T00:00:00Z</td>\n      <td>NA</td>\n      <td>00172462-4604-5a25-b1d4-f057577d68e0</td>\n      <td>E4-2ds v5 Low Priority</td>\n      <td>...</td>\n      <td>Virtual Machines Edsv5 Series Windows</td>\n      <td>E4-2ds v5 Low Priority</td>\n      <td>Virtual Machines</td>\n      <td>DZH313Z7MMC8</td>\n      <td>Compute</td>\n      <td>1 Hour</td>\n      <td>Consumption</td>\n      <td>False</td>\n      <td>Standard_E4-2ds_v5</td>\n      <td>NA</td>\n    </tr>\n    <tr>\n      <th>98</th>\n      <td>USD</td>\n      <td>0.0</td>\n      <td>0.181440</td>\n      <td>0.181440</td>\n      <td>southindia</td>\n      <td>IN South</td>\n      <td>2022-03-01T00:00:00Z</td>\n      <td>2022-03-31T23:59:00Z</td>\n      <td>001752ab-2e87-599e-8fac-f1ada637ca61</td>\n      <td>D5 v2/DS5 v2 Spot</td>\n      <td>...</td>\n      <td>Virtual Machines Dv2 Series</td>\n      <td>D5 v2 Spot</td>\n      <td>Virtual Machines</td>\n      <td>DZH313Z7MMC8</td>\n      <td>Compute</td>\n      <td>1 Hour</td>\n      <td>Consumption</td>\n      <td>True</td>\n      <td>Standard_D5_v2</td>\n      <td>NA</td>\n    </tr>\n    <tr>\n      <th>99</th>\n      <td>USD</td>\n      <td>0.0</td>\n      <td>0.456000</td>\n      <td>0.456000</td>\n      <td>canadacentral</td>\n      <td>CA Central</td>\n      <td>2021-10-01T00:00:00Z</td>\n      <td>NA</td>\n      <td>001790af-f893-596a-b4f9-7b0837df43e3</td>\n      <td>DS13 Low Priority</td>\n      <td>...</td>\n      <td>Virtual Machines DS Series Windows</td>\n      <td>DS13 Low Priority</td>\n      <td>Virtual Machines</td>\n      <td>DZH313Z7MMC8</td>\n      <td>Compute</td>\n      <td>1 Hour</td>\n      <td>Consumption</td>\n      <td>False</td>\n      <td>Standard_DS13</td>\n      <td>NA</td>\n    </tr>\n  </tbody>\n</table>\n<p>100 rows × 22 columns</p>\n</div></div></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><h4>Understand unique type, Typical values are Consumption and Reservation</h4></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[8]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#0000ff\">print</span><span class=\"token\" style=\"color:#393A34\">(</span>pd<span class=\"token\" style=\"color:#393A34\">.</span>unique<span class=\"token\" style=\"color:#393A34\">(</span>df_items_2<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&quot;type&quot;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><code class=\"nteract-display-area-stdout\"><span>[&#x27;DevTestConsumption&#x27; &#x27;Consumption&#x27; &#x27;Reservation&#x27;]\n</span></code></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[9]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#0000ff\">print</span><span class=\"token\" style=\"color:#393A34\">(</span>pd<span class=\"token\" style=\"color:#393A34\">.</span>unique<span class=\"token\" style=\"color:#393A34\">(</span>df_items_2<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&quot;reservationTerm&quot;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><code class=\"nteract-display-area-stdout\"><span>[&#x27;NA&#x27; &#x27;1 Year&#x27; &#x27;3 Years&#x27;]\n</span></code></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[10]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\">df_consumption <span class=\"token\" style=\"color:#393A34\">=</span> df_items_2<span class=\"token\" style=\"color:#393A34\">.</span>loc<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">(</span>df_items_2<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&quot;type&quot;</span><span class=\"token\" style=\"color:#393A34\">]</span> <span class=\"token\" style=\"color:#393A34\">==</span> <span class=\"token\" style=\"color:#A31515\">&quot;Consumption&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">]</span>\ndf_consumption</code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><div><div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>currencyCode</th>\n      <th>tierMinimumUnits</th>\n      <th>retailPrice</th>\n      <th>unitPrice</th>\n      <th>armRegionName</th>\n      <th>location</th>\n      <th>effectiveStartDate</th>\n      <th>effectiveEndDate</th>\n      <th>meterId</th>\n      <th>meterName</th>\n      <th>...</th>\n      <th>productName</th>\n      <th>skuName</th>\n      <th>serviceName</th>\n      <th>serviceId</th>\n      <th>serviceFamily</th>\n      <th>unitOfMeasure</th>\n      <th>type</th>\n      <th>isPrimaryMeterRegion</th>\n      <th>armSkuName</th>\n      <th>reservationTerm</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>1</th>\n      <td>USD</td>\n      <td>0.0</td>\n      <td>0.542506</td>\n      <td>0.542506</td>\n      <td>southindia</td>\n      <td>IN South</td>\n      <td>2022-03-01T00:00:00Z</td>\n      <td>2022-03-31T23:59:00Z</td>\n      <td>000009d0-057f-5f2b-b7e9-9e26add324a8</td>\n      <td>D14/DS14 Spot</td>\n      <td>...</td>\n      <td>Virtual Machines D Series Windows</td>\n      <td>D14 Spot</td>\n      <td>Virtual Machines</td>\n      <td>DZH313Z7MMC8</td>\n      <td>Compute</td>\n      <td>1 Hour</td>\n      <td>Consumption</td>\n      <td>True</td>\n      <td>Standard_D14</td>\n      <td>NA</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>USD</td>\n      <td>0.0</td>\n      <td>1.468006</td>\n      <td>1.468006</td>\n      <td>eastasia</td>\n      <td>AP East</td>\n      <td>2022-03-01T00:00:00Z</td>\n      <td>2022-03-31T23:59:00Z</td>\n      <td>00014e7d-fff9-54dd-962e-4e992887ad3c</td>\n      <td>D64s v5 Spot</td>\n      <td>...</td>\n      <td>Virtual Machines Dsv5 Series Windows</td>\n      <td>Standard_D64s_v5 Spot</td>\n      <td>Virtual Machines</td>\n      <td>DZH313Z7MMC8</td>\n      <td>Compute</td>\n      <td>1 Hour</td>\n      <td>Consumption</td>\n      <td>True</td>\n      <td>Standard_D64s_v5</td>\n      <td>NA</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>USD</td>\n      <td>0.0</td>\n      <td>10.560000</td>\n      <td>10.560000</td>\n      <td>uksouth</td>\n      <td>UK South</td>\n      <td>2018-11-01T00:00:00Z</td>\n      <td>NA</td>\n      <td>0001d427-82df-4d83-8ab2-b60768527e08</td>\n      <td>E10 Disks</td>\n      <td>...</td>\n      <td>Standard SSD Managed Disks</td>\n      <td>E10 LRS</td>\n      <td>Storage</td>\n      <td>DZH317F1HKN0</td>\n      <td>Storage</td>\n      <td>1/Month</td>\n      <td>Consumption</td>\n      <td>True</td>\n      <td></td>\n      <td>NA</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>USD</td>\n      <td>0.0</td>\n      <td>0.190000</td>\n      <td>0.190000</td>\n      <td>uknorth</td>\n      <td>UK North</td>\n      <td>2019-10-16T00:00:00Z</td>\n      <td>NA</td>\n      <td>0001e46a-9285-5fa8-b48a-240e307a24f7</td>\n      <td>A3 Spot</td>\n      <td>...</td>\n      <td>Virtual Machines A Series Windows</td>\n      <td>A3 Spot</td>\n      <td>Virtual Machines</td>\n      <td>DZH313Z7MMC8</td>\n      <td>Compute</td>\n      <td>1 Hour</td>\n      <td>Consumption</td>\n      <td>True</td>\n      <td>Standard_A3</td>\n      <td>NA</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>USD</td>\n      <td>0.0</td>\n      <td>0.075600</td>\n      <td>0.075600</td>\n      <td>westus</td>\n      <td>US West</td>\n      <td>2021-11-01T00:00:00Z</td>\n      <td>NA</td>\n      <td>00026917-5c42-5cf2-994e-4037490635aa</td>\n      <td>E2bds v5 Spot</td>\n      <td>...</td>\n      <td>Virtual Machines Ebdsv5 Series</td>\n      <td>Standard_E2bds_v5 Spot</td>\n      <td>Virtual Machines</td>\n      <td>DZH313Z7MMC8</td>\n      <td>Compute</td>\n      <td>1 Hour</td>\n      <td>Consumption</td>\n      <td>True</td>\n      <td>Standard_E2bds_v5</td>\n      <td>NA</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>91</th>\n      <td>USD</td>\n      <td>0.0</td>\n      <td>4.838000</td>\n      <td>4.838000</td>\n      <td>southcentralus</td>\n      <td>US South Central</td>\n      <td>2020-08-01T00:00:00Z</td>\n      <td>NA</td>\n      <td>0016083a-928f-56fd-8eeb-39287dcf676d</td>\n      <td>E64 v4</td>\n      <td>...</td>\n      <td>Virtual Machines Ev4 Series</td>\n      <td>E64 v4</td>\n      <td>Virtual Machines</td>\n      <td>DZH313Z7MMC8</td>\n      <td>Compute</td>\n      <td>1 Hour</td>\n      <td>Consumption</td>\n      <td>True</td>\n      <td>Standard_E64_v4</td>\n      <td>NA</td>\n    </tr>\n    <tr>\n      <th>95</th>\n      <td>USD</td>\n      <td>0.0</td>\n      <td>0.212000</td>\n      <td>0.212000</td>\n      <td>westcentralus</td>\n      <td>US West Central</td>\n      <td>2021-11-01T00:00:00Z</td>\n      <td>NA</td>\n      <td>00172462-4604-5a25-b1d4-f057577d68e0</td>\n      <td>E4ds v5 Low Priority</td>\n      <td>...</td>\n      <td>Virtual Machines Edsv5 Series Windows</td>\n      <td>E4ds v5 Low Priority</td>\n      <td>Virtual Machines</td>\n      <td>DZH313Z7MMC8</td>\n      <td>Compute</td>\n      <td>1 Hour</td>\n      <td>Consumption</td>\n      <td>True</td>\n      <td>Standard_E4ds_v5</td>\n      <td>NA</td>\n    </tr>\n    <tr>\n      <th>97</th>\n      <td>USD</td>\n      <td>0.0</td>\n      <td>0.212000</td>\n      <td>0.212000</td>\n      <td>westcentralus</td>\n      <td>US West Central</td>\n      <td>2021-11-01T00:00:00Z</td>\n      <td>NA</td>\n      <td>00172462-4604-5a25-b1d4-f057577d68e0</td>\n      <td>E4-2ds v5 Low Priority</td>\n      <td>...</td>\n      <td>Virtual Machines Edsv5 Series Windows</td>\n      <td>E4-2ds v5 Low Priority</td>\n      <td>Virtual Machines</td>\n      <td>DZH313Z7MMC8</td>\n      <td>Compute</td>\n      <td>1 Hour</td>\n      <td>Consumption</td>\n      <td>False</td>\n      <td>Standard_E4-2ds_v5</td>\n      <td>NA</td>\n    </tr>\n    <tr>\n      <th>98</th>\n      <td>USD</td>\n      <td>0.0</td>\n      <td>0.181440</td>\n      <td>0.181440</td>\n      <td>southindia</td>\n      <td>IN South</td>\n      <td>2022-03-01T00:00:00Z</td>\n      <td>2022-03-31T23:59:00Z</td>\n      <td>001752ab-2e87-599e-8fac-f1ada637ca61</td>\n      <td>D5 v2/DS5 v2 Spot</td>\n      <td>...</td>\n      <td>Virtual Machines Dv2 Series</td>\n      <td>D5 v2 Spot</td>\n      <td>Virtual Machines</td>\n      <td>DZH313Z7MMC8</td>\n      <td>Compute</td>\n      <td>1 Hour</td>\n      <td>Consumption</td>\n      <td>True</td>\n      <td>Standard_D5_v2</td>\n      <td>NA</td>\n    </tr>\n    <tr>\n      <th>99</th>\n      <td>USD</td>\n      <td>0.0</td>\n      <td>0.456000</td>\n      <td>0.456000</td>\n      <td>canadacentral</td>\n      <td>CA Central</td>\n      <td>2021-10-01T00:00:00Z</td>\n      <td>NA</td>\n      <td>001790af-f893-596a-b4f9-7b0837df43e3</td>\n      <td>DS13 Low Priority</td>\n      <td>...</td>\n      <td>Virtual Machines DS Series Windows</td>\n      <td>DS13 Low Priority</td>\n      <td>Virtual Machines</td>\n      <td>DZH313Z7MMC8</td>\n      <td>Compute</td>\n      <td>1 Hour</td>\n      <td>Consumption</td>\n      <td>False</td>\n      <td>Standard_DS13</td>\n      <td>NA</td>\n    </tr>\n  </tbody>\n</table>\n<p>72 rows × 22 columns</p>\n</div></div></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[11]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\">dfi_consumption <span class=\"token\" style=\"color:#393A34\">=</span> df_consumption<span class=\"token\" style=\"color:#393A34\">[</span>\n    <span class=\"token\" style=\"color:#393A34\">[</span>\n        <span class=\"token\" style=\"color:#A31515\">&quot;armRegionName&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n        <span class=\"token\" style=\"color:#A31515\">&quot;productName&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n        <span class=\"token\" style=\"color:#A31515\">&quot;skuName&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n        <span class=\"token\" style=\"color:#A31515\">&quot;retailPrice&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n        <span class=\"token\" style=\"color:#A31515\">&quot;currencyCode&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n        <span class=\"token\" style=\"color:#A31515\">&quot;serviceName&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n        <span class=\"token\" style=\"color:#A31515\">&quot;serviceFamily&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n        <span class=\"token\" style=\"color:#A31515\">&quot;reservationTerm&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n        <span class=\"token\" style=\"color:#A31515\">&quot;type&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#393A34\">]</span>\n<span class=\"token\" style=\"color:#393A34\">]</span>\ndfi_consumption</code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><div><div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>armRegionName</th>\n      <th>productName</th>\n      <th>skuName</th>\n      <th>retailPrice</th>\n      <th>currencyCode</th>\n      <th>serviceName</th>\n      <th>serviceFamily</th>\n      <th>reservationTerm</th>\n      <th>type</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>1</th>\n      <td>southindia</td>\n      <td>Virtual Machines D Series Windows</td>\n      <td>D14 Spot</td>\n      <td>0.542506</td>\n      <td>USD</td>\n      <td>Virtual Machines</td>\n      <td>Compute</td>\n      <td>NA</td>\n      <td>Consumption</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>eastasia</td>\n      <td>Virtual Machines Dsv5 Series Windows</td>\n      <td>Standard_D64s_v5 Spot</td>\n      <td>1.468006</td>\n      <td>USD</td>\n      <td>Virtual Machines</td>\n      <td>Compute</td>\n      <td>NA</td>\n      <td>Consumption</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>uksouth</td>\n      <td>Standard SSD Managed Disks</td>\n      <td>E10 LRS</td>\n      <td>10.560000</td>\n      <td>USD</td>\n      <td>Storage</td>\n      <td>Storage</td>\n      <td>NA</td>\n      <td>Consumption</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>uknorth</td>\n      <td>Virtual Machines A Series Windows</td>\n      <td>A3 Spot</td>\n      <td>0.190000</td>\n      <td>USD</td>\n      <td>Virtual Machines</td>\n      <td>Compute</td>\n      <td>NA</td>\n      <td>Consumption</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>westus</td>\n      <td>Virtual Machines Ebdsv5 Series</td>\n      <td>Standard_E2bds_v5 Spot</td>\n      <td>0.075600</td>\n      <td>USD</td>\n      <td>Virtual Machines</td>\n      <td>Compute</td>\n      <td>NA</td>\n      <td>Consumption</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>91</th>\n      <td>southcentralus</td>\n      <td>Virtual Machines Ev4 Series</td>\n      <td>E64 v4</td>\n      <td>4.838000</td>\n      <td>USD</td>\n      <td>Virtual Machines</td>\n      <td>Compute</td>\n      <td>NA</td>\n      <td>Consumption</td>\n    </tr>\n    <tr>\n      <th>95</th>\n      <td>westcentralus</td>\n      <td>Virtual Machines Edsv5 Series Windows</td>\n      <td>E4ds v5 Low Priority</td>\n      <td>0.212000</td>\n      <td>USD</td>\n      <td>Virtual Machines</td>\n      <td>Compute</td>\n      <td>NA</td>\n      <td>Consumption</td>\n    </tr>\n    <tr>\n      <th>97</th>\n      <td>westcentralus</td>\n      <td>Virtual Machines Edsv5 Series Windows</td>\n      <td>E4-2ds v5 Low Priority</td>\n      <td>0.212000</td>\n      <td>USD</td>\n      <td>Virtual Machines</td>\n      <td>Compute</td>\n      <td>NA</td>\n      <td>Consumption</td>\n    </tr>\n    <tr>\n      <th>98</th>\n      <td>southindia</td>\n      <td>Virtual Machines Dv2 Series</td>\n      <td>D5 v2 Spot</td>\n      <td>0.181440</td>\n      <td>USD</td>\n      <td>Virtual Machines</td>\n      <td>Compute</td>\n      <td>NA</td>\n      <td>Consumption</td>\n    </tr>\n    <tr>\n      <th>99</th>\n      <td>canadacentral</td>\n      <td>Virtual Machines DS Series Windows</td>\n      <td>DS13 Low Priority</td>\n      <td>0.456000</td>\n      <td>USD</td>\n      <td>Virtual Machines</td>\n      <td>Compute</td>\n      <td>NA</td>\n      <td>Consumption</td>\n    </tr>\n  </tbody>\n</table>\n<p>72 rows × 9 columns</p>\n</div></div></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><h4>Group by few columns to get region wise Max Price and Min Price</h4></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[12]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\">result_consumption <span class=\"token\" style=\"color:#393A34\">=</span> dfi_consumption<span class=\"token\" style=\"color:#393A34\">.</span>groupby<span class=\"token\" style=\"color:#393A34\">(</span>\n    <span class=\"token\" style=\"color:#393A34\">[</span>\n        <span class=\"token\" style=\"color:#A31515\">&quot;armRegionName&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n        <span class=\"token\" style=\"color:#A31515\">&quot;productName&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n        <span class=\"token\" style=\"color:#A31515\">&quot;skuName&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n        <span class=\"token\" style=\"color:#A31515\">&quot;serviceName&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n        <span class=\"token\" style=\"color:#A31515\">&quot;serviceFamily&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n        <span class=\"token\" style=\"color:#A31515\">&quot;reservationTerm&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n        <span class=\"token\" style=\"color:#A31515\">&quot;type&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#393A34\">]</span>\n<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span>agg<span class=\"token\" style=\"color:#393A34\">(</span>maxPrice<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;retailPrice&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&quot;max&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span> minPrice<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;retailPrice&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&quot;min&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span>\nresult_consumption</code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><div><div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th>maxPrice</th>\n      <th>minPrice</th>\n    </tr>\n    <tr>\n      <th>armRegionName</th>\n      <th>productName</th>\n      <th>skuName</th>\n      <th>serviceName</th>\n      <th>serviceFamily</th>\n      <th>reservationTerm</th>\n      <th>type</th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th></th>\n      <th>SQL Server Web Red Hat Enterprise Linux</th>\n      <th>7 vCPU VM</th>\n      <th>Virtual Machines Licenses</th>\n      <th>Compute</th>\n      <th>NA</th>\n      <th>Consumption</th>\n      <td>0.186000</td>\n      <td>0.186000</td>\n    </tr>\n    <tr>\n      <th>australiaeast</th>\n      <th>Virtual Machines Esv4 Series Windows</th>\n      <th>E64-16s v4 Spot</th>\n      <th>Virtual Machines</th>\n      <th>Compute</th>\n      <th>NA</th>\n      <th>Consumption</th>\n      <td>2.057530</td>\n      <td>2.057530</td>\n    </tr>\n    <tr>\n      <th rowspan=\"2\" valign=\"top\">australiasoutheast</th>\n      <th>Virtual Machines Eadsv5 Series Windows</th>\n      <th>E16-8ads v5 Spot</th>\n      <th>Virtual Machines</th>\n      <th>Compute</th>\n      <th>NA</th>\n      <th>Consumption</th>\n      <td>0.537088</td>\n      <td>0.537088</td>\n    </tr>\n    <tr>\n      <th>Virtual Machines F Series Windows</th>\n      <th>F16 Spot</th>\n      <th>Virtual Machines</th>\n      <th>Compute</th>\n      <th>NA</th>\n      <th>Consumption</th>\n      <td>0.403024</td>\n      <td>0.403024</td>\n    </tr>\n    <tr>\n      <th>brazilsouth</th>\n      <th>Virtual Machines A Series Basic</th>\n      <th>A2</th>\n      <th>Virtual Machines</th>\n      <th>Compute</th>\n      <th>NA</th>\n      <th>Consumption</th>\n      <td>0.112000</td>\n      <td>0.112000</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <th>...</th>\n      <th>...</th>\n      <th>...</th>\n      <th>...</th>\n      <th>...</th>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>westindia</th>\n      <th>Virtual Machines Dv4 Series</th>\n      <th>D2 v4 Low Priority</th>\n      <th>Virtual Machines</th>\n      <th>Compute</th>\n      <th>NA</th>\n      <th>Consumption</th>\n      <td>0.023600</td>\n      <td>0.023600</td>\n    </tr>\n    <tr>\n      <th rowspan=\"2\" valign=\"top\">westus</th>\n      <th>Premium ADLS Gen2 Hierarchical Namespace</th>\n      <th>Premium ZRS</th>\n      <th>Storage</th>\n      <th>Storage</th>\n      <th>NA</th>\n      <th>Consumption</th>\n      <td>0.113000</td>\n      <td>0.113000</td>\n    </tr>\n    <tr>\n      <th>Virtual Machines Ebdsv5 Series</th>\n      <th>Standard_E2bds_v5 Spot</th>\n      <th>Virtual Machines</th>\n      <th>Compute</th>\n      <th>NA</th>\n      <th>Consumption</th>\n      <td>0.075600</td>\n      <td>0.075600</td>\n    </tr>\n    <tr>\n      <th>westus2</th>\n      <th>Virtual Machines Ddsv5 Series</th>\n      <th>Standard_D64ds_v5</th>\n      <th>Virtual Machines</th>\n      <th>Compute</th>\n      <th>NA</th>\n      <th>Consumption</th>\n      <td>3.616000</td>\n      <td>3.616000</td>\n    </tr>\n    <tr>\n      <th>westus3</th>\n      <th>Azure Redis Cache Enterprise Flash</th>\n      <th>F1500</th>\n      <th>Redis Cache</th>\n      <th>Databases</th>\n      <th>NA</th>\n      <th>Consumption</th>\n      <td>10.430000</td>\n      <td>10.430000</td>\n    </tr>\n  </tbody>\n</table>\n<p>67 rows × 2 columns</p>\n</div></div></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><h4>Data analysis to understand service prices for type Reservation</h4></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[13]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\">df_reservation <span class=\"token\" style=\"color:#393A34\">=</span> df_items_2<span class=\"token\" style=\"color:#393A34\">.</span>loc<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">(</span>df_items_2<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&quot;type&quot;</span><span class=\"token\" style=\"color:#393A34\">]</span> <span class=\"token\" style=\"color:#393A34\">==</span> <span class=\"token\" style=\"color:#A31515\">&quot;Reservation&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">]</span>\ndf_reservation</code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><div><div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>currencyCode</th>\n      <th>tierMinimumUnits</th>\n      <th>retailPrice</th>\n      <th>unitPrice</th>\n      <th>armRegionName</th>\n      <th>location</th>\n      <th>effectiveStartDate</th>\n      <th>effectiveEndDate</th>\n      <th>meterId</th>\n      <th>meterName</th>\n      <th>...</th>\n      <th>productName</th>\n      <th>skuName</th>\n      <th>serviceName</th>\n      <th>serviceId</th>\n      <th>serviceFamily</th>\n      <th>unitOfMeasure</th>\n      <th>type</th>\n      <th>isPrimaryMeterRegion</th>\n      <th>armSkuName</th>\n      <th>reservationTerm</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>36</th>\n      <td>USD</td>\n      <td>0.0</td>\n      <td>18689.0</td>\n      <td>18689.0</td>\n      <td>westus2</td>\n      <td>US West 2</td>\n      <td>2021-11-01T00:00:00Z</td>\n      <td>NA</td>\n      <td>000aeefc-dae5-5264-8f64-d0838e160478</td>\n      <td>D64ds v5</td>\n      <td>...</td>\n      <td>Virtual Machines Ddsv5 Series</td>\n      <td>Standard_D64ds_v5</td>\n      <td>Virtual Machines</td>\n      <td>DZH313Z7MMC8</td>\n      <td>Compute</td>\n      <td>1 Hour</td>\n      <td>Reservation</td>\n      <td>True</td>\n      <td>Standard_D64ds_v5</td>\n      <td>1 Year</td>\n    </tr>\n    <tr>\n      <th>37</th>\n      <td>USD</td>\n      <td>0.0</td>\n      <td>36111.0</td>\n      <td>36111.0</td>\n      <td>westus2</td>\n      <td>US West 2</td>\n      <td>2021-11-01T00:00:00Z</td>\n      <td>NA</td>\n      <td>000aeefc-dae5-5264-8f64-d0838e160478</td>\n      <td>D64ds v5</td>\n      <td>...</td>\n      <td>Virtual Machines Ddsv5 Series</td>\n      <td>Standard_D64ds_v5</td>\n      <td>Virtual Machines</td>\n      <td>DZH313Z7MMC8</td>\n      <td>Compute</td>\n      <td>1 Hour</td>\n      <td>Reservation</td>\n      <td>True</td>\n      <td>Standard_D64ds_v5</td>\n      <td>3 Years</td>\n    </tr>\n    <tr>\n      <th>43</th>\n      <td>USD</td>\n      <td>0.0</td>\n      <td>39231.0</td>\n      <td>39231.0</td>\n      <td>koreasouth</td>\n      <td>KR South</td>\n      <td>2021-12-01T00:00:00Z</td>\n      <td>NA</td>\n      <td>000c0948-0687-52ed-8efa-32a3cfa6c9ed</td>\n      <td>Easv4 Type2</td>\n      <td>...</td>\n      <td>Easv4 Series Dedicated Host</td>\n      <td>Easv4 Type2</td>\n      <td>Virtual Machines</td>\n      <td>DZH313Z7MMC8</td>\n      <td>Compute</td>\n      <td>1 Hour</td>\n      <td>Reservation</td>\n      <td>True</td>\n      <td>Easv4_Type2</td>\n      <td>1 Year</td>\n    </tr>\n    <tr>\n      <th>45</th>\n      <td>USD</td>\n      <td>0.0</td>\n      <td>77890.0</td>\n      <td>77890.0</td>\n      <td>koreasouth</td>\n      <td>KR South</td>\n      <td>2021-12-01T00:00:00Z</td>\n      <td>NA</td>\n      <td>000c0948-0687-52ed-8efa-32a3cfa6c9ed</td>\n      <td>Easv4 Type2</td>\n      <td>...</td>\n      <td>Easv4 Series Dedicated Host</td>\n      <td>Easv4 Type2</td>\n      <td>Virtual Machines</td>\n      <td>DZH313Z7MMC8</td>\n      <td>Compute</td>\n      <td>1 Hour</td>\n      <td>Reservation</td>\n      <td>True</td>\n      <td>Easv4_Type2</td>\n      <td>3 Years</td>\n    </tr>\n    <tr>\n      <th>82</th>\n      <td>USD</td>\n      <td>0.0</td>\n      <td>38667.0</td>\n      <td>38667.0</td>\n      <td>usgovarizona</td>\n      <td>US Gov AZ</td>\n      <td>2020-08-01T00:00:00Z</td>\n      <td>NA</td>\n      <td>0014a546-6717-582f-9680-e510e91eae91</td>\n      <td>D64s v4</td>\n      <td>...</td>\n      <td>Virtual Machines Dsv4 Series</td>\n      <td>D64s v4</td>\n      <td>Virtual Machines</td>\n      <td>DZH313Z7MMC8</td>\n      <td>Compute</td>\n      <td>1 Hour</td>\n      <td>Reservation</td>\n      <td>True</td>\n      <td>Standard_D64s_v4</td>\n      <td>3 Years</td>\n    </tr>\n    <tr>\n      <th>83</th>\n      <td>USD</td>\n      <td>0.0</td>\n      <td>20012.0</td>\n      <td>20012.0</td>\n      <td>usgovarizona</td>\n      <td>US Gov AZ</td>\n      <td>2020-08-01T00:00:00Z</td>\n      <td>NA</td>\n      <td>0014a546-6717-582f-9680-e510e91eae91</td>\n      <td>D64s v4</td>\n      <td>...</td>\n      <td>Virtual Machines Dsv4 Series</td>\n      <td>D64s v4</td>\n      <td>Virtual Machines</td>\n      <td>DZH313Z7MMC8</td>\n      <td>Compute</td>\n      <td>1 Hour</td>\n      <td>Reservation</td>\n      <td>True</td>\n      <td>Standard_D64s_v4</td>\n      <td>1 Year</td>\n    </tr>\n    <tr>\n      <th>92</th>\n      <td>USD</td>\n      <td>0.0</td>\n      <td>48318.0</td>\n      <td>48318.0</td>\n      <td>southcentralus</td>\n      <td>US South Central</td>\n      <td>2020-08-01T00:00:00Z</td>\n      <td>NA</td>\n      <td>0016083a-928f-56fd-8eeb-39287dcf676d</td>\n      <td>E64 v4</td>\n      <td>...</td>\n      <td>Virtual Machines Ev4 Series</td>\n      <td>E64 v4</td>\n      <td>Virtual Machines</td>\n      <td>DZH313Z7MMC8</td>\n      <td>Compute</td>\n      <td>1 Hour</td>\n      <td>Reservation</td>\n      <td>True</td>\n      <td>Standard_E64_v4</td>\n      <td>3 Years</td>\n    </tr>\n    <tr>\n      <th>93</th>\n      <td>USD</td>\n      <td>0.0</td>\n      <td>25007.0</td>\n      <td>25007.0</td>\n      <td>southcentralus</td>\n      <td>US South Central</td>\n      <td>2020-08-01T00:00:00Z</td>\n      <td>NA</td>\n      <td>0016083a-928f-56fd-8eeb-39287dcf676d</td>\n      <td>E64 v4</td>\n      <td>...</td>\n      <td>Virtual Machines Ev4 Series</td>\n      <td>E64 v4</td>\n      <td>Virtual Machines</td>\n      <td>DZH313Z7MMC8</td>\n      <td>Compute</td>\n      <td>1 Hour</td>\n      <td>Reservation</td>\n      <td>True</td>\n      <td>Standard_E64_v4</td>\n      <td>1 Year</td>\n    </tr>\n  </tbody>\n</table>\n<p>8 rows × 22 columns</p>\n</div></div></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[14]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\">dfi_reservation <span class=\"token\" style=\"color:#393A34\">=</span> df_reservation<span class=\"token\" style=\"color:#393A34\">[</span>\n    <span class=\"token\" style=\"color:#393A34\">[</span>\n        <span class=\"token\" style=\"color:#A31515\">&quot;armRegionName&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n        <span class=\"token\" style=\"color:#A31515\">&quot;productName&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n        <span class=\"token\" style=\"color:#A31515\">&quot;skuName&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n        <span class=\"token\" style=\"color:#A31515\">&quot;retailPrice&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n        <span class=\"token\" style=\"color:#A31515\">&quot;currencyCode&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n        <span class=\"token\" style=\"color:#A31515\">&quot;serviceName&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n        <span class=\"token\" style=\"color:#A31515\">&quot;serviceFamily&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n        <span class=\"token\" style=\"color:#A31515\">&quot;reservationTerm&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n        <span class=\"token\" style=\"color:#A31515\">&quot;type&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#393A34\">]</span>\n<span class=\"token\" style=\"color:#393A34\">]</span>\ndfi_reservation</code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><div><div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>armRegionName</th>\n      <th>productName</th>\n      <th>skuName</th>\n      <th>retailPrice</th>\n      <th>currencyCode</th>\n      <th>serviceName</th>\n      <th>serviceFamily</th>\n      <th>reservationTerm</th>\n      <th>type</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>36</th>\n      <td>westus2</td>\n      <td>Virtual Machines Ddsv5 Series</td>\n      <td>Standard_D64ds_v5</td>\n      <td>18689.0</td>\n      <td>USD</td>\n      <td>Virtual Machines</td>\n      <td>Compute</td>\n      <td>1 Year</td>\n      <td>Reservation</td>\n    </tr>\n    <tr>\n      <th>37</th>\n      <td>westus2</td>\n      <td>Virtual Machines Ddsv5 Series</td>\n      <td>Standard_D64ds_v5</td>\n      <td>36111.0</td>\n      <td>USD</td>\n      <td>Virtual Machines</td>\n      <td>Compute</td>\n      <td>3 Years</td>\n      <td>Reservation</td>\n    </tr>\n    <tr>\n      <th>43</th>\n      <td>koreasouth</td>\n      <td>Easv4 Series Dedicated Host</td>\n      <td>Easv4 Type2</td>\n      <td>39231.0</td>\n      <td>USD</td>\n      <td>Virtual Machines</td>\n      <td>Compute</td>\n      <td>1 Year</td>\n      <td>Reservation</td>\n    </tr>\n    <tr>\n      <th>45</th>\n      <td>koreasouth</td>\n      <td>Easv4 Series Dedicated Host</td>\n      <td>Easv4 Type2</td>\n      <td>77890.0</td>\n      <td>USD</td>\n      <td>Virtual Machines</td>\n      <td>Compute</td>\n      <td>3 Years</td>\n      <td>Reservation</td>\n    </tr>\n    <tr>\n      <th>82</th>\n      <td>usgovarizona</td>\n      <td>Virtual Machines Dsv4 Series</td>\n      <td>D64s v4</td>\n      <td>38667.0</td>\n      <td>USD</td>\n      <td>Virtual Machines</td>\n      <td>Compute</td>\n      <td>3 Years</td>\n      <td>Reservation</td>\n    </tr>\n    <tr>\n      <th>83</th>\n      <td>usgovarizona</td>\n      <td>Virtual Machines Dsv4 Series</td>\n      <td>D64s v4</td>\n      <td>20012.0</td>\n      <td>USD</td>\n      <td>Virtual Machines</td>\n      <td>Compute</td>\n      <td>1 Year</td>\n      <td>Reservation</td>\n    </tr>\n    <tr>\n      <th>92</th>\n      <td>southcentralus</td>\n      <td>Virtual Machines Ev4 Series</td>\n      <td>E64 v4</td>\n      <td>48318.0</td>\n      <td>USD</td>\n      <td>Virtual Machines</td>\n      <td>Compute</td>\n      <td>3 Years</td>\n      <td>Reservation</td>\n    </tr>\n    <tr>\n      <th>93</th>\n      <td>southcentralus</td>\n      <td>Virtual Machines Ev4 Series</td>\n      <td>E64 v4</td>\n      <td>25007.0</td>\n      <td>USD</td>\n      <td>Virtual Machines</td>\n      <td>Compute</td>\n      <td>1 Year</td>\n      <td>Reservation</td>\n    </tr>\n  </tbody>\n</table>\n</div></div></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[16]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\">result_reservation <span class=\"token\" style=\"color:#393A34\">=</span> dfi_reservation<span class=\"token\" style=\"color:#393A34\">.</span>groupby<span class=\"token\" style=\"color:#393A34\">(</span>\n    <span class=\"token\" style=\"color:#393A34\">[</span>\n        <span class=\"token\" style=\"color:#A31515\">&quot;armRegionName&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n        <span class=\"token\" style=\"color:#A31515\">&quot;productName&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n        <span class=\"token\" style=\"color:#A31515\">&quot;skuName&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n        <span class=\"token\" style=\"color:#A31515\">&quot;serviceName&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n        <span class=\"token\" style=\"color:#A31515\">&quot;serviceFamily&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n        <span class=\"token\" style=\"color:#A31515\">&quot;reservationTerm&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n        <span class=\"token\" style=\"color:#A31515\">&quot;type&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#393A34\">]</span>\n<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span>agg<span class=\"token\" style=\"color:#393A34\">(</span>maxPrice<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;retailPrice&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&quot;max&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span> minPrice<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;retailPrice&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&quot;min&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span>\nresult_reservation</code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><div><div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th>maxPrice</th>\n      <th>minPrice</th>\n    </tr>\n    <tr>\n      <th>armRegionName</th>\n      <th>productName</th>\n      <th>skuName</th>\n      <th>serviceName</th>\n      <th>serviceFamily</th>\n      <th>reservationTerm</th>\n      <th>type</th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th rowspan=\"2\" valign=\"top\">koreasouth</th>\n      <th rowspan=\"2\" valign=\"top\">Easv4 Series Dedicated Host</th>\n      <th rowspan=\"2\" valign=\"top\">Easv4 Type2</th>\n      <th rowspan=\"2\" valign=\"top\">Virtual Machines</th>\n      <th rowspan=\"2\" valign=\"top\">Compute</th>\n      <th>1 Year</th>\n      <th>Reservation</th>\n      <td>39231.0</td>\n      <td>39231.0</td>\n    </tr>\n    <tr>\n      <th>3 Years</th>\n      <th>Reservation</th>\n      <td>77890.0</td>\n      <td>77890.0</td>\n    </tr>\n    <tr>\n      <th rowspan=\"2\" valign=\"top\">southcentralus</th>\n      <th rowspan=\"2\" valign=\"top\">Virtual Machines Ev4 Series</th>\n      <th rowspan=\"2\" valign=\"top\">E64 v4</th>\n      <th rowspan=\"2\" valign=\"top\">Virtual Machines</th>\n      <th rowspan=\"2\" valign=\"top\">Compute</th>\n      <th>1 Year</th>\n      <th>Reservation</th>\n      <td>25007.0</td>\n      <td>25007.0</td>\n    </tr>\n    <tr>\n      <th>3 Years</th>\n      <th>Reservation</th>\n      <td>48318.0</td>\n      <td>48318.0</td>\n    </tr>\n    <tr>\n      <th rowspan=\"2\" valign=\"top\">usgovarizona</th>\n      <th rowspan=\"2\" valign=\"top\">Virtual Machines Dsv4 Series</th>\n      <th rowspan=\"2\" valign=\"top\">D64s v4</th>\n      <th rowspan=\"2\" valign=\"top\">Virtual Machines</th>\n      <th rowspan=\"2\" valign=\"top\">Compute</th>\n      <th>1 Year</th>\n      <th>Reservation</th>\n      <td>20012.0</td>\n      <td>20012.0</td>\n    </tr>\n    <tr>\n      <th>3 Years</th>\n      <th>Reservation</th>\n      <td>38667.0</td>\n      <td>38667.0</td>\n    </tr>\n    <tr>\n      <th rowspan=\"2\" valign=\"top\">westus2</th>\n      <th rowspan=\"2\" valign=\"top\">Virtual Machines Ddsv5 Series</th>\n      <th rowspan=\"2\" valign=\"top\">Standard_D64ds_v5</th>\n      <th rowspan=\"2\" valign=\"top\">Virtual Machines</th>\n      <th rowspan=\"2\" valign=\"top\">Compute</th>\n      <th>1 Year</th>\n      <th>Reservation</th>\n      <td>18689.0</td>\n      <td>18689.0</td>\n    </tr>\n    <tr>\n      <th>3 Years</th>\n      <th>Reservation</th>\n      <td>36111.0</td>\n      <td>36111.0</td>\n    </tr>\n  </tbody>\n</table>\n</div></div></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><h4>Conclusion -</h4>\n<p>For the type Consumption In most of the cases across regions, there is slight variation between min and max price\nFor the type Reservation prices are fixed. Max min price analysis is not required.</p></div></div></div></div>","fields":{"srcLink":"https://github.com/aicoe-aiops/cloud-price-analysis-public/blob/master/notebooks/experimental/cloud_price_analysis_azure.ipynb"}}},"pageContext":{"id":"492a4d39-dcbe-52d3-bea2-71de9b7e2e78 >>> JupyterNotebook"}},"staticQueryHashes":["1764348645","2823140819","3000541721","3606484676"]}