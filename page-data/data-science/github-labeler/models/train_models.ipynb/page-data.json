{"componentChunkName":"component---src-templates-jupyter-notebook-js","path":"/data-science/github-labeler/models/train_models.ipynb","result":{"data":{"site":{"siteMetadata":{"title":"Operate First"}},"jupyterNotebook":{"id":"0957a9ac-7f88-536d-9c54-139c961ee016 >>> JupyterNotebook","html":"<div class=\"notebook-render\"><div class=\"sc-ifAKCX zMCZx\"><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><h1>Model Training</h1></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><p>In this notebook we train models to predict issue labels and test which models are effective. The basic flow of the notebook is such: one reads in the data, examines it and sets some parameters such as ignored labels, then trains both a SVM and fastText model as a binary classification task on each label. Negative samples are taken evenly throughout the other labels. Whichever labels&#x27; models perform better than some specified benchmark are then trained on the whole dataset and saved to Ceph. A text file is saved containing which labels&#x27; models are saved that a Flask app will then perform inference on.</p></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><h2>Load Data and Environment Variables</h2></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[1]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#0000ff\">import</span> pandas <span class=\"token\" style=\"color:#0000ff\">as</span> pd\n<span class=\"token\" style=\"color:#0000ff\">import</span> numpy <span class=\"token\" style=\"color:#0000ff\">as</span> np\n<span class=\"token\" style=\"color:#0000ff\">import</span> itertools\n<span class=\"token\" style=\"color:#0000ff\">import</span> collections\n<span class=\"token\" style=\"color:#0000ff\">import</span> os\n<span class=\"token\" style=\"color:#0000ff\">import</span> seaborn <span class=\"token\" style=\"color:#0000ff\">as</span> sns\n<span class=\"token\" style=\"color:#0000ff\">from</span> sklearn<span class=\"token\" style=\"color:#393A34\">.</span>model_selection <span class=\"token\" style=\"color:#0000ff\">import</span> train_test_split\n<span class=\"token\" style=\"color:#0000ff\">import</span> boto3\n<span class=\"token\" style=\"color:#0000ff\">from</span> dotenv <span class=\"token\" style=\"color:#0000ff\">import</span> load_dotenv<span class=\"token\" style=\"color:#393A34\">,</span> find_dotenv\n<span class=\"token\" style=\"color:#0000ff\">import</span> sys\n<span class=\"token\" style=\"color:#0000ff\">from</span> joblib <span class=\"token\" style=\"color:#0000ff\">import</span> dump\n<span class=\"token\" style=\"color:#0000ff\">from</span> model_classes <span class=\"token\" style=\"color:#0000ff\">import</span> FtModel<span class=\"token\" style=\"color:#393A34\">,</span> SVM\n<span class=\"token\" style=\"color:#0000ff\">from</span> sklearn<span class=\"token\" style=\"color:#393A34\">.</span>feature_extraction<span class=\"token\" style=\"color:#393A34\">.</span>text <span class=\"token\" style=\"color:#0000ff\">import</span> TfidfVectorizer\n\nsys<span class=\"token\" style=\"color:#393A34\">.</span>path<span class=\"token\" style=\"color:#393A34\">.</span>append<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;../src/data&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span>  <span class=\"token\" style=\"color:#008000;font-style:italic\"># noqa</span>\n<span class=\"token\" style=\"color:#0000ff\">from</span> preprocess <span class=\"token\" style=\"color:#0000ff\">import</span> process  <span class=\"token\" style=\"color:#008000;font-style:italic\"># noqa</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><code class=\"nteract-display-area-stderr\"><span>[nltk_data] Downloading package stopwords to\n[nltk_data]     /home/atersaak/nltk_data...\n[nltk_data]   Package stopwords is already up-to-date!\n[nltk_data] Downloading package punkt to /home/atersaak/nltk_data...\n[nltk_data]   Package punkt is already up-to-date!\n</span></code></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[2]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># load environment variables</span>\nload_dotenv<span class=\"token\" style=\"color:#393A34\">(</span>find_dotenv<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><pre><code><span>True</span></code></pre></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[3]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># whether to use ceph or store locally</span>\n\nuse_ceph <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token builtin\">bool</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token builtin\">int</span><span class=\"token\" style=\"color:#393A34\">(</span>os<span class=\"token\" style=\"color:#393A34\">.</span>getenv<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;USE_CEPH&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span>\n\n<span class=\"token\" style=\"color:#0000ff\">if</span> use_ceph<span class=\"token\" style=\"color:#393A34\">:</span>\n    s3_endpoint_url <span class=\"token\" style=\"color:#393A34\">=</span> os<span class=\"token\" style=\"color:#393A34\">.</span>environ<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&quot;OBJECT_STORAGE_ENDPOINT_URL&quot;</span><span class=\"token\" style=\"color:#393A34\">]</span>\n    s3_access_key <span class=\"token\" style=\"color:#393A34\">=</span> os<span class=\"token\" style=\"color:#393A34\">.</span>environ<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&quot;AWS_ACCESS_KEY_ID&quot;</span><span class=\"token\" style=\"color:#393A34\">]</span>\n    s3_secret_key <span class=\"token\" style=\"color:#393A34\">=</span> os<span class=\"token\" style=\"color:#393A34\">.</span>environ<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&quot;AWS_SECRET_ACCESS_KEY&quot;</span><span class=\"token\" style=\"color:#393A34\">]</span>\n    s3_bucket <span class=\"token\" style=\"color:#393A34\">=</span> os<span class=\"token\" style=\"color:#393A34\">.</span>environ<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&quot;OBJECT_STORAGE_BUCKET_NAME&quot;</span><span class=\"token\" style=\"color:#393A34\">]</span>\n\n    s3 <span class=\"token\" style=\"color:#393A34\">=</span> boto3<span class=\"token\" style=\"color:#393A34\">.</span>client<span class=\"token\" style=\"color:#393A34\">(</span>\n        service_name<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&quot;s3&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n        aws_access_key_id<span class=\"token\" style=\"color:#393A34\">=</span>s3_access_key<span class=\"token\" style=\"color:#393A34\">,</span>\n        aws_secret_access_key<span class=\"token\" style=\"color:#393A34\">=</span>s3_secret_key<span class=\"token\" style=\"color:#393A34\">,</span>\n        endpoint_url<span class=\"token\" style=\"color:#393A34\">=</span>s3_endpoint_url<span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[4]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\">name <span class=\"token\" style=\"color:#393A34\">=</span> os<span class=\"token\" style=\"color:#393A34\">.</span>getenv<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;REPO_NAME&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span>\n\n<span class=\"token\" style=\"color:#0000ff\">if</span> <span class=\"token\" style=\"color:#A31515\">&quot;/&quot;</span> <span class=\"token\" style=\"color:#0000ff\">in</span> name<span class=\"token\" style=\"color:#393A34\">:</span>\n    REPO <span class=\"token\" style=\"color:#393A34\">=</span> name\n    USER <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#A31515\">&quot;&quot;</span>\n<span class=\"token\" style=\"color:#0000ff\">else</span><span class=\"token\" style=\"color:#393A34\">:</span>\n    USER <span class=\"token\" style=\"color:#393A34\">=</span> name\n    REPO <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#A31515\">&quot;&quot;</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[5]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># repo data is saved as {org_name}-_-{repo_name}</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># orginization data is saved as {org_name}</span>\n\nsavename <span class=\"token\" style=\"color:#393A34\">=</span> USER <span class=\"token\" style=\"color:#0000ff\">if</span> USER <span class=\"token\" style=\"color:#0000ff\">else</span> REPO<span class=\"token\" style=\"color:#393A34\">.</span>replace<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;/&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&quot;-_-&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span>\npath <span class=\"token\" style=\"color:#393A34\">=</span> os<span class=\"token\" style=\"color:#393A34\">.</span>path<span class=\"token\" style=\"color:#393A34\">.</span>join<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;../data&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span> savename <span class=\"token\" style=\"color:#393A34\">+</span> <span class=\"token\" style=\"color:#A31515\">&quot;.csv&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span>\nkey <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token string-interpolation\"><span class=\"token\" style=\"color:#A31515\">f&quot;github-labeler/data/</span><span class=\"token interpolation\"><span class=\"token\" style=\"color:#393A34\">{</span>savename<span class=\"token\" style=\"color:#393A34\">}</span></span><span class=\"token\" style=\"color:#A31515\">.csv&quot;</span></span>\n\n<span class=\"token\" style=\"color:#0000ff\">if</span> use_ceph<span class=\"token\" style=\"color:#393A34\">:</span>\n    response <span class=\"token\" style=\"color:#393A34\">=</span> s3<span class=\"token\" style=\"color:#393A34\">.</span>get_object<span class=\"token\" style=\"color:#393A34\">(</span>Bucket<span class=\"token\" style=\"color:#393A34\">=</span>s3_bucket<span class=\"token\" style=\"color:#393A34\">,</span> Key<span class=\"token\" style=\"color:#393A34\">=</span>key<span class=\"token\" style=\"color:#393A34\">)</span>\n    issues_df <span class=\"token\" style=\"color:#393A34\">=</span> pd<span class=\"token\" style=\"color:#393A34\">.</span>read_csv<span class=\"token\" style=\"color:#393A34\">(</span>response<span class=\"token\" style=\"color:#393A34\">.</span>get<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;Body&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span>drop_duplicates<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span>\n<span class=\"token\" style=\"color:#0000ff\">else</span><span class=\"token\" style=\"color:#393A34\">:</span>\n    issues_df <span class=\"token\" style=\"color:#393A34\">=</span> pd<span class=\"token\" style=\"color:#393A34\">.</span>read_csv<span class=\"token\" style=\"color:#393A34\">(</span>path<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span>drop_duplicates<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[6]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\">issues_df<span class=\"token\" style=\"color:#393A34\">.</span>sample<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">5</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><div><div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>id</th>\n      <th>repo</th>\n      <th>title</th>\n      <th>body</th>\n      <th>created_at</th>\n      <th>created_by</th>\n      <th>num_labels</th>\n      <th>labels</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>100</th>\n      <td>openshift/origin/601</td>\n      <td>openshift/origin</td>\n      <td>Newer versions of go-bindata include modtime i...</td>\n      <td>During the rebase I attempted to pull go-binda...</td>\n      <td>2014-12-27 03:16:28</td>\n      <td>smarterclayton</td>\n      <td>1</td>\n      <td>kind/bug</td>\n    </tr>\n    <tr>\n      <th>8804</th>\n      <td>openshift/origin/25020</td>\n      <td>openshift/origin</td>\n      <td>Unable to start minishift</td>\n      <td>I installed virtual box latest version and dow...</td>\n      <td>2020-05-24 14:14:36</td>\n      <td>rathohit311356</td>\n      <td>1</td>\n      <td>lifecycle/rotten</td>\n    </tr>\n    <tr>\n      <th>5238</th>\n      <td>openshift/origin/13606</td>\n      <td>openshift/origin</td>\n      <td>Ansible task failure (permission denied)</td>\n      <td>```\\r\\nTASK [openshift_sanitize_inventory : En...</td>\n      <td>2017-04-03 16:33:25</td>\n      <td>bparees</td>\n      <td>3</td>\n      <td>priority/P1\\tcomponent/install\\tkind/test-flake</td>\n    </tr>\n    <tr>\n      <th>4055</th>\n      <td>openshift/origin/10436</td>\n      <td>openshift/origin</td>\n      <td>add node,\"type: NodePort\" doesn't work, Pod on...</td>\n      <td>add a node:ansible-playbook playbooks/byo/open...</td>\n      <td>2016-08-16 07:40:45</td>\n      <td>lifei825</td>\n      <td>3</td>\n      <td>priority/P3\\tcomponent/networking\\tlifecycle/s...</td>\n    </tr>\n    <tr>\n      <th>156</th>\n      <td>openshift/origin/859</td>\n      <td>openshift/origin</td>\n      <td>Builder panics if Dockerfile missing</td>\n      <td>[`docker.go` line 143 &amp; 144](https://github.co...</td>\n      <td>2015-02-03 23:04:05</td>\n      <td>phemmer</td>\n      <td>1</td>\n      <td>kind/bug</td>\n    </tr>\n  </tbody>\n</table>\n</div></div></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><h2>EDA and Customization</h2></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><p>Here we examine the labels a bit. We can define any labels that are synonyms and define bots whose issues we don&#x27;t want to include</p></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[7]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># outputwith all labels more samples than &quot;cutoff&quot;, in order.</span>\n\ncutoff <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#36acaa\">100</span>\n\nlabel_lst <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token builtin\">list</span><span class=\"token\" style=\"color:#393A34\">(</span>\n    itertools<span class=\"token\" style=\"color:#393A34\">.</span>chain<span class=\"token\" style=\"color:#393A34\">.</span>from_iterable<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">[</span>ls<span class=\"token\" style=\"color:#393A34\">.</span>split<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;\\t&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span> <span class=\"token\" style=\"color:#0000ff\">for</span> ls <span class=\"token\" style=\"color:#0000ff\">in</span> issues_df<span class=\"token\" style=\"color:#393A34\">.</span>labels<span class=\"token\" style=\"color:#393A34\">.</span>dropna<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">)</span>\n<span class=\"token\" style=\"color:#393A34\">)</span>\ncounter <span class=\"token\" style=\"color:#393A34\">=</span> collections<span class=\"token\" style=\"color:#393A34\">.</span>Counter<span class=\"token\" style=\"color:#393A34\">(</span>label_lst<span class=\"token\" style=\"color:#393A34\">)</span>\n\n<span class=\"token\" style=\"color:#0000ff\">for</span> a<span class=\"token\" style=\"color:#393A34\">,</span> b <span class=\"token\" style=\"color:#0000ff\">in</span> counter<span class=\"token\" style=\"color:#393A34\">.</span>most_common<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span>\n    <span class=\"token\" style=\"color:#0000ff\">if</span> b <span class=\"token\" style=\"color:#393A34\">&gt;</span> cutoff<span class=\"token\" style=\"color:#393A34\">:</span>\n        <span class=\"token\" style=\"color:#0000ff\">print</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token string-interpolation\"><span class=\"token\" style=\"color:#A31515\">f&quot;</span><span class=\"token interpolation\"><span class=\"token\" style=\"color:#393A34\">{</span>a<span class=\"token\" style=\"color:#393A34\">}</span></span><span class=\"token\" style=\"color:#A31515\"> </span><span class=\"token interpolation\"><span class=\"token\" style=\"color:#393A34\">{</span>b<span class=\"token\" style=\"color:#393A34\">}</span></span><span class=\"token\" style=\"color:#A31515\">&quot;</span></span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><code class=\"nteract-display-area-stdout\"><span>priority/P2 3507\nkind/bug 1868\nlifecycle/rotten 1800\npriority/P3 1387\npriority/P1 1215\nkind/test-flake 1085\ncomponent/cli 873\nkind/question 748\narea/usability 655\ncomponent/build 648\ncomponent/web 637\narea/tests 599\ncomponent/apps 485\ncomponent/kubernetes 391\ncomponent/imageregistry 324\ncomponent/networking 323\nlifecycle/stale 305\ncomponent/auth 298\nsig/master 298\narea/techdebt 294\ncomponent/routing 245\ncomponent/restapi 208\narea/security 197\npriority/P0 197\ncomponent/storage 187\ncomponent/internal-tools 173\ncomponent/install 169\nlifecycle/frozen 163\nsig/developer-experience 163\nkind/post-rebase 153\ncomponent/composition 145\ncomponent/image 135\nsig/security 125\nsig/networking 118\narea/documentation 114\narea/performance 101\ncomponent/cluster-up 101\n</span></code></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[8]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># define synonyms, first in set will be used name</span>\n\nsynsets <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#393A34\">[</span>\n    <span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&quot;kind/bug&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&quot;bug&quot;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span>\n<span class=\"token\" style=\"color:#393A34\">]</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[9]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># equate synonyms</span>\n\n<span class=\"token\" style=\"color:#0000ff\">for</span> syn <span class=\"token\" style=\"color:#0000ff\">in</span> synsets<span class=\"token\" style=\"color:#393A34\">:</span>\n\n    <span class=\"token\" style=\"color:#0000ff\">def</span> <span class=\"token\" style=\"color:#393A34\">equate_syns</span><span class=\"token\" style=\"color:#393A34\">(</span>lbl<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span>\n        <span class=\"token\" style=\"color:#0000ff\">return</span> syn<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">]</span> <span class=\"token\" style=\"color:#0000ff\">if</span> lbl <span class=\"token\" style=\"color:#0000ff\">in</span> syn<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#393A34\">]</span> <span class=\"token\" style=\"color:#0000ff\">else</span> lbl\n\n    <span class=\"token\" style=\"color:#0000ff\">def</span> <span class=\"token\" style=\"color:#393A34\">equate_list</span><span class=\"token\" style=\"color:#393A34\">(</span>lbllist<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span>\n        <span class=\"token\" style=\"color:#0000ff\">if</span> <span class=\"token builtin\">type</span><span class=\"token\" style=\"color:#393A34\">(</span>lbllist<span class=\"token\" style=\"color:#393A34\">)</span> <span class=\"token\" style=\"color:#393A34\">==</span> <span class=\"token builtin\">str</span><span class=\"token\" style=\"color:#393A34\">:</span>\n            <span class=\"token\" style=\"color:#0000ff\">return</span> <span class=\"token\" style=\"color:#A31515\">&quot;\\t&quot;</span><span class=\"token\" style=\"color:#393A34\">.</span>join<span class=\"token\" style=\"color:#393A34\">(</span>\n                <span class=\"token builtin\">list</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token builtin\">set</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">[</span>equate_syns<span class=\"token\" style=\"color:#393A34\">(</span>lbl<span class=\"token\" style=\"color:#393A34\">)</span> <span class=\"token\" style=\"color:#0000ff\">for</span> lbl <span class=\"token\" style=\"color:#0000ff\">in</span> lbllist<span class=\"token\" style=\"color:#393A34\">.</span>split<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;\\t&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span>\n            <span class=\"token\" style=\"color:#393A34\">)</span>\n        <span class=\"token\" style=\"color:#0000ff\">else</span><span class=\"token\" style=\"color:#393A34\">:</span>\n            <span class=\"token\" style=\"color:#0000ff\">return</span> lbllist\n\n    issues_df<span class=\"token\" style=\"color:#393A34\">.</span>labels <span class=\"token\" style=\"color:#393A34\">=</span> issues_df<span class=\"token\" style=\"color:#393A34\">.</span>labels<span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">apply</span><span class=\"token\" style=\"color:#393A34\">(</span>equate_list<span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[10]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># output histogram of number of labels</span>\n\nax <span class=\"token\" style=\"color:#393A34\">=</span> sns<span class=\"token\" style=\"color:#393A34\">.</span>histplot<span class=\"token\" style=\"color:#393A34\">(</span>issues_df<span class=\"token\" style=\"color:#393A34\">.</span>num_labels<span class=\"token\" style=\"color:#393A34\">,</span> bins<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token builtin\">int</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token builtin\">max</span><span class=\"token\" style=\"color:#393A34\">(</span>issues_df<span class=\"token\" style=\"color:#393A34\">.</span>num_labels<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span>\nax<span class=\"token\" style=\"color:#393A34\">.</span>set_xlim<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">6</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><pre><code><span>(0.0, 6.0)</span></code></pre><img alt=\"\" src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAY4AAAEJCAYAAACDscAcAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/MnkTPAAAACXBIWXMAAAsTAAALEwEAmpwYAAAVBElEQVR4nO3dcdBddZ3f8fcHAsIibqCkmZjECbVxd9C2QGNUsFuUEZBui+46Am0hddyGVrAwbu2AO1PctczYWdfdulI0StbQsgSqUKNSMSKudRVIgjEQkJIiNIlooqwoa6sGvv3j/oLXmCfPPfG5z32em/dr5s4953d+55zvgYHPc8753XNSVUiSNKjDRl2AJGl2MTgkSZ0YHJKkTgwOSVInBockqRODQ5LUydCCI8lRSe5N8vUkW5P8fms/Mck9SbYluTnJka39eW1+W1u+pG9bV7X2h5OcPayaJUmTy7B+x5EkwDFV9XSSI4AvA5cD7wBuraq1ST4EfL2qrkvyNuDvVtW/SnIB8MaqOj/JScBNwHLghcDngZdU1TMT7fuEE06oJUuWDOW4JGlcbdq06btVNW+yfnOGVUD1EunpNntE+xTwWuCftvY1wLuB64Dz2jTAx4EPtvA5D1hbVT8GvplkG70Q+epE+16yZAkbN26cysORpLGX5PFB+g31HkeSw5NsBnYB64H/DXy/qva0LjuAhW16IbAdoC1/Cvgb/e37WUeSNM2GGhxV9UxVnQwsoneW8OvD2leSlUk2Jtm4e/fuYe1Gkg550zKqqqq+D9wFvAqYm2TvJbJFwM42vRNYDNCW/yrwvf72/azTv49VVbWsqpbNmzfpJTpJ0kEa5qiqeUnmtumjgdcBD9ELkDe1biuAT7bpdW2etvwL7T7JOuCCNurqRGApcO+w6pYkHdjQbo4DC4A1SQ6nF1C3VNWnkzwIrE3yH4CvAde3/tcD/6Xd/H4SuACgqrYmuQV4ENgDXHqgEVWSpOEa2nDcUVq2bFk5qkqSukmyqaqWTdbPX45LkjoxOCRJnRgckqRODA5pmi1c/CKSjO1n4eIXjfofsYZsmKOqJO3Ht3Zs5/wPf2XUZQzNzZecNuoSNGSecUiSOjE4JEmdGBySpE4MDklSJwaHJKkTg0OS1InBIUnqxOCQJHVicEiSOjE4JEmdGBySpE4MDklSJwaHJKkTg0OS1InBIUnqxOCQJHVicEiSOjE4JEmdGBySpE4MDklSJwaHJKkTg0OS1MnQgiPJ4iR3JXkwydYkl7f2dyfZmWRz+5zbt85VSbYleTjJ2X3t57S2bUmuHFbNkqTJzRnitvcAv1tV9yU5FtiUZH1b9sdV9b7+zklOAi4AXgq8EPh8kpe0xdcCrwN2ABuSrKuqB4dYuyRpAkMLjqp6AniiTf8wyUPAwgOsch6wtqp+DHwzyTZgeVu2raoeBUiytvU1OCRpBKblHkeSJcApwD2t6bIkW5KsTnJca1sIbO9bbUdrm6hdkjQCQw+OJM8HPgFcUVU/AK4DXgycTO+M5I+maD8rk2xMsnH37t1TsUlJ0n4MNTiSHEEvNG6sqlsBquo7VfVMVT0LfISfXY7aCSzuW31Ra5uo/edU1aqqWlZVy+bNmzf1ByNJAoY7qirA9cBDVfX+vvYFfd3eCDzQptcBFyR5XpITgaXAvcAGYGmSE5McSe8G+rph1S1JOrBhjqo6HbgIuD/J5tb2LuDCJCcDBTwGXAJQVVuT3ELvpvce4NKqegYgyWXAHcDhwOqq2jrEuiVJBzDMUVVfBrKfRbcfYJ1rgGv20377gdaTJE0ffzkuSerE4JAkdWJwSJI6MTgkSZ0YHJKkTgwOSVInBockqRODQ5LUicEhSerE4JAkdWJwSJI6MTgkSZ0YHJKkTgwOSVInBockqRODQ5LUicEhSerE4JAkdWJwSJI6MTgkSZ0YHJKkTgwOSVInBockqRODQ5LUicEhSerE4JAkdWJwSJI6GVpwJFmc5K4kDybZmuTy1n58kvVJHmnfx7X2JPlAkm1JtiQ5tW9bK1r/R5KsGFbNkqTJDfOMYw/wu1V1EvBK4NIkJwFXAndW1VLgzjYP8HpgafusBK6DXtAAVwOvAJYDV+8NG0nS9BtacFTVE1V1X5v+IfAQsBA4D1jTuq0B3tCmzwNuqJ67gblJFgBnA+ur6smq+itgPXDOsOqWJB3YtNzjSLIEOAW4B5hfVU+0Rd8G5rfphcD2vtV2tLaJ2vfdx8okG5Ns3L1799QegCTpOUMPjiTPBz4BXFFVP+hfVlUF1FTsp6pWVdWyqlo2b968qdikJGk/hhocSY6gFxo3VtWtrfk77RIU7XtXa98JLO5bfVFrm6hdkjQCwxxVFeB64KGqen/fonXA3pFRK4BP9rVf3EZXvRJ4ql3SugM4K8lx7ab4Wa1NkjQCc4a47dOBi4D7k2xube8C3gvckuStwOPAm9uy24FzgW3Aj4C3AFTVk0neA2xo/f6gqp4cYt2SpAMYWnBU1ZeBTLD4zP30L+DSCba1Glg9ddVJkg6WvxyXJHVicEiSOjE4JEmdGBySpE4MDklSJ8McjisdlIWLX8S3dmyfvKOkkTA4NON8a8d2zv/wV0ZdxtDcfMlpoy5B+qV4qUqS1InBIUnqxOCQJHVicEiSOjE4JEmdGBySpE4MDklSJwaHJKkTg0OS1MlAwZHk9EHaJEnjb9Azjj8dsE2SNOYO+KyqJK8CTgPmJXlH36IXAIcPszBJ0sw02UMOjwSe3/od29f+A+BNwypKkjRzHTA4quovgL9I8rGqenyaapIkzWCDPlb9eUlWAUv616mq1w6jKEnSzDVocPw34EPAR4FnhleOJGmmGzQ49lTVdUOtRJI0Kww6HPdTSd6WZEGS4/d+hlqZJGlGGvSMY0X7fmdfWwF/a2rLkSTNdAMFR1WdOOxCJEmzw6CPHLl4f59J1lmdZFeSB/ra3p1kZ5LN7XNu37KrkmxL8nCSs/vaz2lt25JceTAHKUmaOoNeqnp53/RRwJnAfcANB1jnY8AH99Pnj6vqff0NSU4CLgBeCrwQ+HySl7TF1wKvA3YAG5Ksq6oHB6xbkjTFBr1U9fb++SRzgbWTrPOlJEsGrOM8YG1V/Rj4ZpJtwPK2bFtVPdr2u7b1NTgkaUQO9rHqfw0c7H2Py5JsaZeyjmttC4HtfX12tLaJ2n9BkpVJNibZuHv37oMsTZI0mUHvcXwqybr2+QzwMHDbQezvOuDFwMnAE8AfHcQ29quqVlXVsqpaNm/evKnarCRpH4Pe4+i/J7EHeLyqdnTdWVV9Z+90ko8An26zO4HFfV0XtTYO0C5JGoGBzjjaww6/Qe8JuccBPzmYnSVZ0Df7RmDviKt1wAVJnpfkRGApcC+wAVia5MQkR9K7gb7uYPYtSZoaA51xJHkz8IfAF4EAf5rknVX18QOscxNwBnBCkh3A1cAZSU6m9+PBx4BLAKpqa5Jb6N303gNcWlXPtO1cBtxB7/0fq6tqa+ejlDR9DptDklFXMRQvXLSYndv/z6jLGLlBL1X9HvDyqtoFkGQe8HlgwuCoqgv303z9AfpfA1yzn/bbgdsHrFPSqD27h/M//JVRVzEUN19y2qhLmBEGHVV12N7QaL7XYV1J0hgZ9Izjs0nuAG5q8+fjWYAkHZIme+f43wbmV9U7k/wW8Oq26KvAjcMuTpI080x2xvEnwFUAVXUrcCtAkr/Tlv3jIdYmSZqBJrtPMb+q7t+3sbUtGUpFkqQZbbLgmHuAZUdPYR2SpFlisuDYmORf7tuY5HeATcMpSZI0k012j+MK4LYk/4yfBcUy4Eh6v/yWJB1iDhgc7dlSpyV5DfCy1vyZqvrC0CuTJM1Ig76P4y7griHXIkmaBfz1tySpE4NDktSJwSFJ6sTgkCR1YnBIkjoxOCRJnQz6WPVZZcuWLWP7BjLwLWSSRmssg+OnP/3p2L6BDHwLmaTR8lKVJKkTg0OS1InBIUnqxOCQJHUyljfHx95hc8Z61Jikmc3gmI2e3eOoMUkj46UqSVInBockqRODQ5LUydCCI8nqJLuSPNDXdnyS9Ukead/HtfYk+UCSbUm2JDm1b50Vrf8jSVYMq15J0mCGecbxMeCcfdquBO6sqqXAnW0e4PXA0vZZCVwHvaABrgZeASwHrt4bNpKk0RhacFTVl4An92k+D1jTptcAb+hrv6F67gbmJlkAnA2sr6onq+qvgPX8YhhJkqbRdA/HnV9VT7TpbwPz2/RCYHtfvx2tbaL2X5BkJb2zFUnSEI3sdxxVVUlqCre3ClgFMJXblST9vOkeVfWddgmK9r2rte8EFvf1W9TaJmqXJI3IdAfHOmDvyKgVwCf72i9uo6teCTzVLmndAZyV5Lh2U/ys1iZJGpGhXapKchNwBnBCkh30Rke9F7glyVuBx4E3t+63A+cC24AfAW8BqKonk7wH2ND6/UFV7XvDXZI0jYYWHFV14QSLztxP3wIunWA7q4HVU1iaJOmX4C/HJUmdGBySpE4MDklSJwaHJKkTg0OS1InBIUnqxOCQJHVicEiSOjE4JEmdGBySpE4MDklSJwaHJKkTg0OS1InBIUnqxOCQJHVicEiSOjE4JEmdGBySpE4MDklSJwaHJKkTg0OS1InBIUnqxOCQJHVicEiSOjE4JEmdGBySpE4MDklSJyMJjiSPJbk/yeYkG1vb8UnWJ3mkfR/X2pPkA0m2JdmS5NRR1CxJ6hnlGcdrqurkqlrW5q8E7qyqpcCdbR7g9cDS9lkJXDftlUqSnjOTLlWdB6xp02uAN/S131A9dwNzkywYQX2SJEYXHAV8LsmmJCtb2/yqeqJNfxuY36YXAtv71t3R2n5OkpVJNu699CVJGo45I9rvq6tqZ5K/CaxP8o3+hVVVSarLBqtqFbAKoOu6kqTBjeSMo6p2tu9dwG3AcuA7ey9Bte9drftOYHHf6otamyRpBKY9OJIck+TYvdPAWcADwDpgReu2Avhkm14HXNxGV70SeKrvkpYkaZqN4lLVfOC2JHv3/+dV9dkkG4BbkrwVeBx4c+t/O3AusA34EfCW6S9ZkrTXtAdHVT0K/L39tH8POHM/7QVcOg2lSZIGMJOG40qSZgGDQ5LUicEhSerE4JAkdTKqHwBK0uxz2BzaiNBDmsEhSYN6dg/nf/gro65iaG6+5LSB+nmpSpLUicEhSerE4JAkdWJwSJI6MTgkSZ0YHJKkTgwOSVInBockqRODQ5LUicEhSerE4JAkdWJwSJI6MTgkSZ0YHJKkTgwOSVInBockqRODQ5LUicEhSerE4JAkdWJwSJI6mTXBkeScJA8n2ZbkylHXI0mHqlkRHEkOB64FXg+cBFyY5KTRViVJh6ZZERzAcmBbVT1aVT8B1gLnjbgmSTokzZbgWAhs75vf0dokSdMsVTXqGiaV5E3AOVX1O23+IuAVVXVZX5+VwMo2+zLggWkvdPqcAHx31EUMkcc3u43z8Y3zsQH8WlUdO1mnOdNRyRTYCSzum1/U2p5TVauAVQBJNlbVsukrb3p5fLObxzd7jfOxQe/4Buk3Wy5VbQCWJjkxyZHABcC6EdckSYekWXHGUVV7klwG3AEcDqyuqq0jLkuSDkmzIjgAqup24PYBu68aZi0zgMc3u3l8s9c4HxsMeHyz4ua4JGnmmC33OCRJM8TYBcc4P5okyeoku5KM5VDjJIuT3JXkwSRbk1w+6pqmSpKjktyb5Ovt2H5/1DUNQ5LDk3wtyadHXctUS/JYkvuTbB509NFskmRuko8n+UaSh5K8asK+43Spqj2a5H8Br6P3I8ENwIVV9eBIC5siSX4DeBq4oapeNup6plqSBcCCqrovybHAJuAN4/DvL0mAY6rq6SRHAF8GLq+qu0dc2pRK8g5gGfCCqvrNUdczlZI8BiyrqrH8HUeSNcD/rKqPttGrv1JV399f33E74xjrR5NU1ZeAJ0ddx7BU1RNVdV+b/iHwEGPyhIDqebrNHtE+4/NXG5BkEfCPgI+OuhZ1k+RXgd8Argeoqp9MFBowfsHho0nGRJIlwCnAPSMuZcq0yzibgV3A+qoam2Nr/gT4d8CzI65jWAr4XJJN7UkV4+REYDfwZ+1S40eTHDNR53ELDo2BJM8HPgFcUVU/GHU9U6Wqnqmqk+k9+WB5krG53JjkN4FdVbVp1LUM0aur6lR6T+m+tF06HhdzgFOB66rqFOCvgQnvEY9bcEz6aBLNbO36/yeAG6vq1lHXMwztEsBdwDkjLmUqnQ78k3YfYC3w2iT/dbQlTa2q2tm+dwG30bs0Pi52ADv6zoI/Ti9I9mvcgsNHk8xi7Qby9cBDVfX+UdczlZLMSzK3TR9NbwDHN0Za1BSqqquqalFVLaH3390Xquqfj7isKZPkmDZgg3YJ5yzG6EGqVfVtYHuSX2tNZwITDkqZNb8cH8S4P5okyU3AGcAJSXYAV1fV9aOtakqdDlwE3N/uBQC8qz01YLZbAKxpI/8OA26pqrEbsjrG5gO39f62YQ7w51X12dGWNOXeDtzY/uh+FHjLRB3HajiuJGn4xu1SlSRpyAwOSVInBockqRODQ5LUicEhSerE4JAkdWJwSNMoyceSvGmSPl9MsqzDNs8Yx8eYa+YyOCRJnRgcOuQlWdJeXPOR9pKlzyU5uv8v/yQntOcwkeRfJPnvSda3l/tcluQd7amidyc5fsD9/vskG5I8kGRVe+TKXhe1FwY9kGR5639Me5nXvW1fv/DKgCT/sK23ufU59pf/JyT9PIND6lkKXFtVLwW+D/z2JP1fBvwW8HLgGuBH7amiXwUuHnCfH6yql7eXch0N9L/46Ffak3TfBqxubb9H7xlQy4HXAH+4n0df/1vg0rbuPwD+74C1SAMzOKSeb1bV5ja9CVgySf+7quqHVbUbeAr4VGu/f4B193pNknuS3A+8Fnhp37Kb4LmXd72gPSDxLODK9hyvLwJHAS/aZ5t/Cbw/yb8B5lbVngFrkQY2Vg85lH4JP+6bfobeGcAefvbH1VEH6P9s3/yzDPDfVZKjgP9M71Wk25O8e5997PsQuQIC/HZVPbzPtuY/16nqvUk+A5wL/GWSs6tqbJ7Cq5nBMw5pYo8Bf79NH3Ak1EHYGxLfbS+u2nf75wMkeTXwVFU9Re+pz2/fey8kySn7bjTJi6vq/qr6j/ReM/DrU1y3ZHBIB/A+4F8n+RpwwlRuuL3M6SP03ulwB73/yff7f22/HwLe2treQ+9d5VuSbG3z+7qi3VDfAvwU+B9TWbcEPlZdktSRZxySpE68OS4NQZJr6b3RsN9/qqo/G0U90lTyUpUkqRMvVUmSOjE4JEmdGBySpE4MDklSJwaHJKmT/w8vfcmyWlss/QAAAABJRU5ErkJggg==\n\" class=\"sc-bdVaJa jFcqvn\"/></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[11]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># view most common issue creators</span>\n\nissues_df<span class=\"token\" style=\"color:#393A34\">.</span>created_by<span class=\"token\" style=\"color:#393A34\">.</span>value_counts<span class=\"token\" style=\"color:#393A34\">(</span>ascending<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">False</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span>head<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">10</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><pre><code><span>smarterclayton    767\ndeads2k           374\nkargakis          361\nspadgett          349\nbparees           297\nliggitt           276\nstevekuznetsov    273\nmfojtik           256\nsoltysh           139\nsosiouxme         108\nName: created_by, dtype: int64</span></code></pre></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[12]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># first find bots transparently tagged as such</span>\n\n\n<span class=\"token\" style=\"color:#0000ff\">def</span> <span class=\"token\" style=\"color:#393A34\">is_bot</span><span class=\"token\" style=\"color:#393A34\">(</span>name<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span>\n    <span class=\"token\" style=\"color:#0000ff\">return</span> name<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">-</span><span class=\"token\" style=\"color:#36acaa\">5</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#393A34\">]</span> <span class=\"token\" style=\"color:#393A34\">==</span> <span class=\"token\" style=\"color:#A31515\">&quot;[bot]&quot;</span>\n\n\nall_names <span class=\"token\" style=\"color:#393A34\">=</span> issues_df<span class=\"token\" style=\"color:#393A34\">.</span>created_by<span class=\"token\" style=\"color:#393A34\">.</span>unique<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span>\n\nbots <span class=\"token\" style=\"color:#393A34\">=</span> all_names<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">[</span>is_bot<span class=\"token\" style=\"color:#393A34\">(</span>x<span class=\"token\" style=\"color:#393A34\">)</span> <span class=\"token\" style=\"color:#0000ff\">for</span> x <span class=\"token\" style=\"color:#0000ff\">in</span> all_names<span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">]</span>\n\n<span class=\"token\" style=\"color:#0000ff\">print</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;bots found:&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span>\n<span class=\"token\" style=\"color:#0000ff\">for</span> b <span class=\"token\" style=\"color:#0000ff\">in</span> bots<span class=\"token\" style=\"color:#393A34\">:</span>\n    <span class=\"token\" style=\"color:#0000ff\">print</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;\\t&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span> b<span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><code class=\"nteract-display-area-stdout\"><span>bots found:\n</span></code></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[13]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># choose any additional bot accounts whose issues to not count</span>\n\nadditional_bots <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&quot;sesheta&quot;</span><span class=\"token\" style=\"color:#393A34\">]</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[14]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># filter out issues created by bots &amp; their labels</span>\n\nbots <span class=\"token\" style=\"color:#393A34\">=</span> np<span class=\"token\" style=\"color:#393A34\">.</span>concatenate<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">(</span>bots<span class=\"token\" style=\"color:#393A34\">,</span> additional_bots<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span>\n\nissues_df <span class=\"token\" style=\"color:#393A34\">=</span> issues_df<span class=\"token\" style=\"color:#393A34\">[</span>issues_df<span class=\"token\" style=\"color:#393A34\">.</span>created_by<span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">apply</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#0000ff\">lambda</span> x<span class=\"token\" style=\"color:#393A34\">:</span> x <span class=\"token\" style=\"color:#0000ff\">not</span> <span class=\"token\" style=\"color:#0000ff\">in</span> bots<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">]</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[15]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># most popular labels, nearly finalized</span>\n\ncutoff <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#36acaa\">50</span>\nfinal_labels <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">]</span>\n\nlabel_lst <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token builtin\">list</span><span class=\"token\" style=\"color:#393A34\">(</span>\n    itertools<span class=\"token\" style=\"color:#393A34\">.</span>chain<span class=\"token\" style=\"color:#393A34\">.</span>from_iterable<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">[</span>ls<span class=\"token\" style=\"color:#393A34\">.</span>split<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;\\t&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span> <span class=\"token\" style=\"color:#0000ff\">for</span> ls <span class=\"token\" style=\"color:#0000ff\">in</span> issues_df<span class=\"token\" style=\"color:#393A34\">.</span>labels<span class=\"token\" style=\"color:#393A34\">.</span>dropna<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">)</span>\n<span class=\"token\" style=\"color:#393A34\">)</span>\ncounter <span class=\"token\" style=\"color:#393A34\">=</span> collections<span class=\"token\" style=\"color:#393A34\">.</span>Counter<span class=\"token\" style=\"color:#393A34\">(</span>label_lst<span class=\"token\" style=\"color:#393A34\">)</span>\n\n<span class=\"token\" style=\"color:#0000ff\">for</span> a<span class=\"token\" style=\"color:#393A34\">,</span> b <span class=\"token\" style=\"color:#0000ff\">in</span> counter<span class=\"token\" style=\"color:#393A34\">.</span>most_common<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span>\n    <span class=\"token\" style=\"color:#0000ff\">if</span> b <span class=\"token\" style=\"color:#393A34\">&gt;</span> cutoff<span class=\"token\" style=\"color:#393A34\">:</span>\n        <span class=\"token\" style=\"color:#0000ff\">print</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token string-interpolation\"><span class=\"token\" style=\"color:#A31515\">f&quot;</span><span class=\"token interpolation\"><span class=\"token\" style=\"color:#393A34\">{</span>a<span class=\"token\" style=\"color:#393A34\">}</span></span><span class=\"token\" style=\"color:#A31515\"> </span><span class=\"token interpolation\"><span class=\"token\" style=\"color:#393A34\">{</span>b<span class=\"token\" style=\"color:#393A34\">}</span></span><span class=\"token\" style=\"color:#A31515\">&quot;</span></span><span class=\"token\" style=\"color:#393A34\">)</span>\n        final_labels<span class=\"token\" style=\"color:#393A34\">.</span>append<span class=\"token\" style=\"color:#393A34\">(</span>a<span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><code class=\"nteract-display-area-stdout\"><span>priority/P2 3507\nkind/bug 1868\nlifecycle/rotten 1800\npriority/P3 1387\npriority/P1 1215\nkind/test-flake 1085\ncomponent/cli 873\nkind/question 748\narea/usability 655\ncomponent/build 648\ncomponent/web 637\narea/tests 599\ncomponent/apps 485\ncomponent/kubernetes 391\ncomponent/imageregistry 324\ncomponent/networking 323\nlifecycle/stale 305\ncomponent/auth 298\nsig/master 298\narea/techdebt 294\ncomponent/routing 245\ncomponent/restapi 208\narea/security 197\npriority/P0 197\ncomponent/storage 187\ncomponent/internal-tools 173\ncomponent/install 169\nlifecycle/frozen 163\nsig/developer-experience 163\nkind/post-rebase 153\ncomponent/composition 145\ncomponent/image 135\nsig/security 125\nsig/networking 118\narea/documentation 114\narea/performance 101\ncomponent/cluster-up 101\narea/infrastructure 83\ncomponent/logging 75\nsig/pod 69\nhelp wanted 67\nsig/storage 66\ncomponent/metrics 65\nkind/feature 55\ncomponent/containers 52\n</span></code></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><p>Here we can choose some labels that will discard an issue entirely from the dataset (e.g. &#x27;bot&#x27; label), and we can choose some labels which we do not want to train a model to predict.</p></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[16]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># choose labels whose issues you don&#x27;t want to include in the dset (for either positive or negative sampling)</span>\n\nexclude <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">]</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[17]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># remove those labels</span>\n\n<span class=\"token\" style=\"color:#0000ff\">for</span> lbl <span class=\"token\" style=\"color:#0000ff\">in</span> exclude<span class=\"token\" style=\"color:#393A34\">:</span>\n    <span class=\"token\" style=\"color:#0000ff\">if</span> lbl <span class=\"token\" style=\"color:#0000ff\">in</span> final_labels<span class=\"token\" style=\"color:#393A34\">:</span>\n        final_labels<span class=\"token\" style=\"color:#393A34\">.</span>remove<span class=\"token\" style=\"color:#393A34\">(</span>lbl<span class=\"token\" style=\"color:#393A34\">)</span>\n\n\n<span class=\"token\" style=\"color:#0000ff\">def</span> <span class=\"token\" style=\"color:#393A34\">inclusion</span><span class=\"token\" style=\"color:#393A34\">(</span>lbl_list<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span>\n    <span class=\"token\" style=\"color:#0000ff\">if</span> <span class=\"token builtin\">type</span><span class=\"token\" style=\"color:#393A34\">(</span>lbl_list<span class=\"token\" style=\"color:#393A34\">)</span> <span class=\"token\" style=\"color:#393A34\">==</span> <span class=\"token builtin\">str</span><span class=\"token\" style=\"color:#393A34\">:</span>\n        <span class=\"token\" style=\"color:#0000ff\">return</span> <span class=\"token\" style=\"color:#0000ff\">not</span> <span class=\"token builtin\">any</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">[</span>lbl <span class=\"token\" style=\"color:#0000ff\">in</span> lbl_list<span class=\"token\" style=\"color:#393A34\">.</span>split<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;\\t&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span> <span class=\"token\" style=\"color:#0000ff\">for</span> lbl <span class=\"token\" style=\"color:#0000ff\">in</span> exclude<span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">)</span>\n    <span class=\"token\" style=\"color:#0000ff\">else</span><span class=\"token\" style=\"color:#393A34\">:</span>\n        <span class=\"token\" style=\"color:#0000ff\">return</span> <span class=\"token\" style=\"color:#36acaa\">True</span>\n\n\nnot_containing <span class=\"token\" style=\"color:#393A34\">=</span> issues_df<span class=\"token\" style=\"color:#393A34\">.</span>labels<span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">apply</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#0000ff\">lambda</span> x<span class=\"token\" style=\"color:#393A34\">:</span> inclusion<span class=\"token\" style=\"color:#393A34\">(</span>x<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span>\nissues_df <span class=\"token\" style=\"color:#393A34\">=</span> issues_df<span class=\"token\" style=\"color:#393A34\">[</span>not_containing<span class=\"token\" style=\"color:#393A34\">]</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[18]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># choose issues you do not wish to attempt to predict</span>\n\ndont_pred <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#393A34\">[</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;priority/P2&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;lifecycle/frozen&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;lifecycle/stale&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;priority/P3&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;priority/P1&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;lifecycle/rotten&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;priority/P0&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;lifecycle/rotten&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n<span class=\"token\" style=\"color:#393A34\">]</span>\n\n<span class=\"token\" style=\"color:#0000ff\">for</span> dp <span class=\"token\" style=\"color:#0000ff\">in</span> dont_pred<span class=\"token\" style=\"color:#393A34\">:</span>\n    <span class=\"token\" style=\"color:#0000ff\">if</span> dp <span class=\"token\" style=\"color:#0000ff\">in</span> final_labels<span class=\"token\" style=\"color:#393A34\">:</span>\n        final_labels<span class=\"token\" style=\"color:#393A34\">.</span>remove<span class=\"token\" style=\"color:#393A34\">(</span>dp<span class=\"token\" style=\"color:#393A34\">)</span>\n    <span class=\"token\" style=\"color:#0000ff\">else</span><span class=\"token\" style=\"color:#393A34\">:</span>\n        <span class=\"token\" style=\"color:#0000ff\">continue</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[19]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># output histogram of number of relevant labels, finalized</span>\n\nset_dp <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token builtin\">set</span><span class=\"token\" style=\"color:#393A34\">(</span>dont_pred<span class=\"token\" style=\"color:#393A34\">)</span>\n\nnum_rel_issues <span class=\"token\" style=\"color:#393A34\">=</span> issues_df<span class=\"token\" style=\"color:#393A34\">.</span>labels<span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">apply</span><span class=\"token\" style=\"color:#393A34\">(</span>\n    <span class=\"token\" style=\"color:#0000ff\">lambda</span> x<span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token builtin\">set</span><span class=\"token\" style=\"color:#393A34\">(</span>x<span class=\"token\" style=\"color:#393A34\">.</span>split<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;\\t&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span>difference<span class=\"token\" style=\"color:#393A34\">(</span>set_dp<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span> <span class=\"token\" style=\"color:#0000ff\">if</span> <span class=\"token builtin\">type</span><span class=\"token\" style=\"color:#393A34\">(</span>x<span class=\"token\" style=\"color:#393A34\">)</span> <span class=\"token\" style=\"color:#393A34\">==</span> <span class=\"token builtin\">str</span> <span class=\"token\" style=\"color:#0000ff\">else</span> <span class=\"token\" style=\"color:#36acaa\">0</span>\n<span class=\"token\" style=\"color:#393A34\">)</span>\n\nax <span class=\"token\" style=\"color:#393A34\">=</span> sns<span class=\"token\" style=\"color:#393A34\">.</span>histplot<span class=\"token\" style=\"color:#393A34\">(</span>num_rel_issues<span class=\"token\" style=\"color:#393A34\">,</span> bins<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token builtin\">int</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token builtin\">max</span><span class=\"token\" style=\"color:#393A34\">(</span>num_rel_issues<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span>\nax<span class=\"token\" style=\"color:#393A34\">.</span>set_xlim<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">6</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><pre><code><span>(0.0, 6.0)</span></code></pre><img alt=\"\" src=\"data:image/png;base64,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\n\" class=\"sc-bdVaJa jFcqvn\"/></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><h2>Processing and Training Functions</h2></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[20]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># preprocess text</span>\n\nissues_df<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&quot;processed&quot;</span><span class=\"token\" style=\"color:#393A34\">]</span> <span class=\"token\" style=\"color:#393A34\">=</span> issues_df<span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">apply</span><span class=\"token\" style=\"color:#393A34\">(</span>\n    <span class=\"token\" style=\"color:#0000ff\">lambda</span> row<span class=\"token\" style=\"color:#393A34\">:</span> np<span class=\"token\" style=\"color:#393A34\">.</span>array<span class=\"token\" style=\"color:#393A34\">(</span>process<span class=\"token\" style=\"color:#393A34\">(</span>row<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&quot;title&quot;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span> row<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&quot;body&quot;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span> axis<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">1</span>\n<span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[21]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># hacky way to make tfidf work on also tokenized text</span>\n\n\n<span class=\"token\" style=\"color:#0000ff\">def</span> <span class=\"token\" style=\"color:#393A34\">dummy_fun</span><span class=\"token\" style=\"color:#393A34\">(</span>doc<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span>\n    <span class=\"token\" style=\"color:#0000ff\">return</span> doc\n\n\ntfidf <span class=\"token\" style=\"color:#393A34\">=</span> TfidfVectorizer<span class=\"token\" style=\"color:#393A34\">(</span>\n    analyzer<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&quot;word&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span> tokenizer<span class=\"token\" style=\"color:#393A34\">=</span>dummy_fun<span class=\"token\" style=\"color:#393A34\">,</span> preprocessor<span class=\"token\" style=\"color:#393A34\">=</span>dummy_fun<span class=\"token\" style=\"color:#393A34\">,</span> token_pattern<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">None</span>\n<span class=\"token\" style=\"color:#393A34\">)</span>\n\ntfidf<span class=\"token\" style=\"color:#393A34\">.</span>fit<span class=\"token\" style=\"color:#393A34\">(</span>issues_df<span class=\"token\" style=\"color:#393A34\">.</span>processed<span class=\"token\" style=\"color:#393A34\">.</span>values<span class=\"token\" style=\"color:#393A34\">)</span>\n\ndump<span class=\"token\" style=\"color:#393A34\">(</span>tfidf<span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&#x27;tfidf.joblib&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span>\n\n<span class=\"token\" style=\"color:#0000ff\">if</span> use_ceph<span class=\"token\" style=\"color:#393A34\">:</span>\n    s3<span class=\"token\" style=\"color:#393A34\">.</span>upload_file<span class=\"token\" style=\"color:#393A34\">(</span>\n        Bucket<span class=\"token\" style=\"color:#393A34\">=</span>s3_bucket<span class=\"token\" style=\"color:#393A34\">,</span>\n        Key<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token string-interpolation\"><span class=\"token\" style=\"color:#A31515\">f&quot;github-labeler/</span><span class=\"token interpolation\"><span class=\"token\" style=\"color:#393A34\">{</span>savename<span class=\"token\" style=\"color:#393A34\">}</span></span><span class=\"token\" style=\"color:#A31515\">/tfidf.joblib&quot;</span></span><span class=\"token\" style=\"color:#393A34\">,</span>\n        Filename<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&quot;tfidf.joblib&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><p>In the function below we have a method for even negative sampling amongst the other labels.</p></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[22]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#0000ff\">def</span> <span class=\"token\" style=\"color:#393A34\">get_subdataset</span><span class=\"token\" style=\"color:#393A34\">(</span>label<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span>\n    <span class=\"token triple-quoted-string\" style=\"color:#A31515\">&quot;&quot;&quot;\n    pass in a label name and get back a dataframe of positive &amp; negative samples for the label\n    we avoid taking unlabelled data as negative samples\n    negative samples are distributed evenly amongst the other labels\n    &quot;&quot;&quot;</span>\n    labelled <span class=\"token\" style=\"color:#393A34\">=</span> issues_df<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">~</span>issues_df<span class=\"token\" style=\"color:#393A34\">.</span>labels<span class=\"token\" style=\"color:#393A34\">.</span>isna<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">]</span>\n    final_labels_ <span class=\"token\" style=\"color:#393A34\">=</span> final_labels<span class=\"token\" style=\"color:#393A34\">.</span>copy<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span>\n    final_labels_<span class=\"token\" style=\"color:#393A34\">.</span>remove<span class=\"token\" style=\"color:#393A34\">(</span>label<span class=\"token\" style=\"color:#393A34\">)</span>\n    pos_samples <span class=\"token\" style=\"color:#393A34\">=</span> labelled<span class=\"token\" style=\"color:#393A34\">[</span>labelled<span class=\"token\" style=\"color:#393A34\">.</span>labels<span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">apply</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#0000ff\">lambda</span> x<span class=\"token\" style=\"color:#393A34\">:</span> label <span class=\"token\" style=\"color:#0000ff\">in</span> x<span class=\"token\" style=\"color:#393A34\">.</span>split<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;\\t&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">]</span>\n    n <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span>pos_samples<span class=\"token\" style=\"color:#393A34\">)</span>\n    remaining <span class=\"token\" style=\"color:#393A34\">=</span> labelled<span class=\"token\" style=\"color:#393A34\">[</span>labelled<span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">id</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">apply</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#0000ff\">lambda</span> x<span class=\"token\" style=\"color:#393A34\">:</span> label <span class=\"token\" style=\"color:#0000ff\">not</span> <span class=\"token\" style=\"color:#0000ff\">in</span> x<span class=\"token\" style=\"color:#393A34\">.</span>split<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;\\t&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">]</span>\n    n_neg <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#36acaa\">0</span>\n    per_label <span class=\"token\" style=\"color:#393A34\">=</span> n <span class=\"token\" style=\"color:#393A34\">//</span> <span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span>final_labels_<span class=\"token\" style=\"color:#393A34\">)</span>\n    neg_ids <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token builtin\">set</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span>\n    <span class=\"token\" style=\"color:#008000;font-style:italic\"># evenly sample if we can</span>\n    <span class=\"token\" style=\"color:#008000;font-style:italic\"># if not enough samples for a label, throw them all in and increase the remaining amount we need per label</span>\n    <span class=\"token\" style=\"color:#0000ff\">for</span> i<span class=\"token\" style=\"color:#393A34\">,</span> lbl <span class=\"token\" style=\"color:#0000ff\">in</span> <span class=\"token builtin\">enumerate</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token builtin\">reversed</span><span class=\"token\" style=\"color:#393A34\">(</span>final_labels_<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span>\n        neg_samples <span class=\"token\" style=\"color:#393A34\">=</span> remaining<span class=\"token\" style=\"color:#393A34\">[</span>remaining<span class=\"token\" style=\"color:#393A34\">.</span>labels<span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">apply</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#0000ff\">lambda</span> x<span class=\"token\" style=\"color:#393A34\">:</span> lbl <span class=\"token\" style=\"color:#0000ff\">in</span> x<span class=\"token\" style=\"color:#393A34\">.</span>split<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;\\t&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">]</span>\n        <span class=\"token\" style=\"color:#0000ff\">if</span> <span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span>neg_samples<span class=\"token\" style=\"color:#393A34\">)</span> <span class=\"token\" style=\"color:#393A34\">&gt;=</span> per_label<span class=\"token\" style=\"color:#393A34\">:</span>\n            neg_samples <span class=\"token\" style=\"color:#393A34\">=</span> neg_samples<span class=\"token\" style=\"color:#393A34\">.</span>sample<span class=\"token\" style=\"color:#393A34\">(</span>per_label<span class=\"token\" style=\"color:#393A34\">)</span>\n            n_neg <span class=\"token\" style=\"color:#393A34\">+=</span> per_label\n        <span class=\"token\" style=\"color:#0000ff\">else</span><span class=\"token\" style=\"color:#393A34\">:</span>\n            n_neg <span class=\"token\" style=\"color:#393A34\">+=</span> <span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span>neg_samples<span class=\"token\" style=\"color:#393A34\">)</span>\n            <span class=\"token\" style=\"color:#0000ff\">if</span> i <span class=\"token\" style=\"color:#393A34\">!=</span> <span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span>final_labels_<span class=\"token\" style=\"color:#393A34\">)</span> <span class=\"token\" style=\"color:#393A34\">-</span> <span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">:</span>\n                per_label <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#393A34\">(</span>n <span class=\"token\" style=\"color:#393A34\">-</span> n_neg<span class=\"token\" style=\"color:#393A34\">)</span> <span class=\"token\" style=\"color:#393A34\">//</span> <span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span>final_labels_<span class=\"token\" style=\"color:#393A34\">)</span> <span class=\"token\" style=\"color:#393A34\">-</span> i <span class=\"token\" style=\"color:#393A34\">-</span> <span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">)</span>\n        remaining <span class=\"token\" style=\"color:#393A34\">=</span> remaining<span class=\"token\" style=\"color:#393A34\">[</span>\n            remaining<span class=\"token\" style=\"color:#393A34\">.</span>labels<span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">apply</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#0000ff\">lambda</span> x<span class=\"token\" style=\"color:#393A34\">:</span> lbl <span class=\"token\" style=\"color:#0000ff\">not</span> <span class=\"token\" style=\"color:#0000ff\">in</span> x<span class=\"token\" style=\"color:#393A34\">.</span>split<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;\\t&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span>\n        <span class=\"token\" style=\"color:#393A34\">]</span>\n        neg_ids <span class=\"token\" style=\"color:#393A34\">=</span> neg_ids<span class=\"token\" style=\"color:#393A34\">.</span>union<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token builtin\">set</span><span class=\"token\" style=\"color:#393A34\">(</span>neg_samples<span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">id</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span>\n    <span class=\"token\" style=\"color:#008000;font-style:italic\"># fill in potential gap with unlabelled issues, if needed</span>\n    <span class=\"token\" style=\"color:#0000ff\">if</span> <span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span>pos_samples<span class=\"token\" style=\"color:#393A34\">)</span> <span class=\"token\" style=\"color:#393A34\">&gt;</span> <span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span>neg_ids<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span>\n        unlabelled <span class=\"token\" style=\"color:#393A34\">=</span> issues_df<span class=\"token\" style=\"color:#393A34\">.</span>query<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;num_labels == 0&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span>\n        <span class=\"token\" style=\"color:#0000ff\">if</span> <span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span>unlabelled<span class=\"token\" style=\"color:#393A34\">)</span> <span class=\"token\" style=\"color:#393A34\">&gt;</span> <span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span>pos_samples<span class=\"token\" style=\"color:#393A34\">)</span> <span class=\"token\" style=\"color:#393A34\">-</span> <span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span>neg_ids<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span>\n            neg_ids <span class=\"token\" style=\"color:#393A34\">=</span> neg_ids<span class=\"token\" style=\"color:#393A34\">.</span>union<span class=\"token\" style=\"color:#393A34\">(</span>\n                <span class=\"token builtin\">set</span><span class=\"token\" style=\"color:#393A34\">(</span>unlabelled<span class=\"token\" style=\"color:#393A34\">.</span>sample<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span>pos_samples<span class=\"token\" style=\"color:#393A34\">)</span> <span class=\"token\" style=\"color:#393A34\">-</span> <span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span>neg_ids<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">id</span><span class=\"token\" style=\"color:#393A34\">)</span>\n            <span class=\"token\" style=\"color:#393A34\">)</span>\n        <span class=\"token\" style=\"color:#0000ff\">else</span><span class=\"token\" style=\"color:#393A34\">:</span>\n            neg_ids <span class=\"token\" style=\"color:#393A34\">=</span> neg_ids<span class=\"token\" style=\"color:#393A34\">.</span>union<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token builtin\">set</span><span class=\"token\" style=\"color:#393A34\">(</span>unlabelled<span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">id</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span>\n            pos_samples <span class=\"token\" style=\"color:#393A34\">=</span> pos_samples<span class=\"token\" style=\"color:#393A34\">.</span>sample<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span>neg_ids<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span>\n    final_neg_samples <span class=\"token\" style=\"color:#393A34\">=</span> issues_df<span class=\"token\" style=\"color:#393A34\">[</span>issues_df<span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">id</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">apply</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#0000ff\">lambda</span> x<span class=\"token\" style=\"color:#393A34\">:</span> x <span class=\"token\" style=\"color:#0000ff\">in</span> neg_ids<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">]</span>\n    x <span class=\"token\" style=\"color:#393A34\">=</span> pd<span class=\"token\" style=\"color:#393A34\">.</span>concat<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">(</span>final_neg_samples<span class=\"token\" style=\"color:#393A34\">,</span> pos_samples<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span>\n    y <span class=\"token\" style=\"color:#393A34\">=</span> np<span class=\"token\" style=\"color:#393A34\">.</span>concatenate<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">(</span>np<span class=\"token\" style=\"color:#393A34\">.</span>zeros<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span>final_neg_samples<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span> np<span class=\"token\" style=\"color:#393A34\">.</span>ones<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span>pos_samples<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span>\n    <span class=\"token\" style=\"color:#0000ff\">return</span> x<span class=\"token\" style=\"color:#393A34\">,</span> y<span class=\"token\" style=\"color:#393A34\">.</span>astype<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token builtin\">int</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[23]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#0000ff\">def</span> <span class=\"token\" style=\"color:#393A34\">predict_label</span><span class=\"token\" style=\"color:#393A34\">(</span>x_train<span class=\"token\" style=\"color:#393A34\">,</span> y_train<span class=\"token\" style=\"color:#393A34\">,</span> x_test<span class=\"token\" style=\"color:#393A34\">,</span> y_test<span class=\"token\" style=\"color:#393A34\">,</span> model_class<span class=\"token\" style=\"color:#393A34\">=</span>FtModel<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span>\n    <span class=\"token triple-quoted-string\" style=\"color:#A31515\">&quot;&quot;&quot;\n    validates fastText model on the given label\n    &quot;&quot;&quot;</span>\n    model <span class=\"token\" style=\"color:#393A34\">=</span> model_class<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span>\n    model<span class=\"token\" style=\"color:#393A34\">.</span>fit<span class=\"token\" style=\"color:#393A34\">(</span>x_train<span class=\"token\" style=\"color:#393A34\">,</span> y_train<span class=\"token\" style=\"color:#393A34\">)</span>\n    preds <span class=\"token\" style=\"color:#393A34\">=</span> model<span class=\"token\" style=\"color:#393A34\">.</span>predict<span class=\"token\" style=\"color:#393A34\">(</span>x_test<span class=\"token\" style=\"color:#393A34\">)</span>\n    acc <span class=\"token\" style=\"color:#393A34\">=</span> np<span class=\"token\" style=\"color:#393A34\">.</span>mean<span class=\"token\" style=\"color:#393A34\">(</span>preds <span class=\"token\" style=\"color:#393A34\">==</span> y_test<span class=\"token\" style=\"color:#393A34\">)</span>\n    precision_ <span class=\"token\" style=\"color:#393A34\">=</span> preds<span class=\"token\" style=\"color:#393A34\">[</span>preds <span class=\"token\" style=\"color:#393A34\">==</span> <span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span> <span class=\"token\" style=\"color:#393A34\">==</span> y_test<span class=\"token\" style=\"color:#393A34\">[</span>preds <span class=\"token\" style=\"color:#393A34\">==</span> <span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span>\n    <span class=\"token\" style=\"color:#0000ff\">if</span> <span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span>precision_<span class=\"token\" style=\"color:#393A34\">)</span> <span class=\"token\" style=\"color:#393A34\">!=</span> <span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">:</span>\n        prec <span class=\"token\" style=\"color:#393A34\">=</span> np<span class=\"token\" style=\"color:#393A34\">.</span>mean<span class=\"token\" style=\"color:#393A34\">(</span>precision_<span class=\"token\" style=\"color:#393A34\">)</span>\n    <span class=\"token\" style=\"color:#0000ff\">else</span><span class=\"token\" style=\"color:#393A34\">:</span>\n        prec <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#36acaa\">None</span>\n    recall_ <span class=\"token\" style=\"color:#393A34\">=</span> preds<span class=\"token\" style=\"color:#393A34\">[</span>y_test <span class=\"token\" style=\"color:#393A34\">==</span> <span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span> <span class=\"token\" style=\"color:#393A34\">==</span> y_test<span class=\"token\" style=\"color:#393A34\">[</span>y_test <span class=\"token\" style=\"color:#393A34\">==</span> <span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span>\n    <span class=\"token\" style=\"color:#0000ff\">if</span> <span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span>recall_<span class=\"token\" style=\"color:#393A34\">)</span> <span class=\"token\" style=\"color:#393A34\">!=</span> <span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">:</span>\n        rec <span class=\"token\" style=\"color:#393A34\">=</span> np<span class=\"token\" style=\"color:#393A34\">.</span>mean<span class=\"token\" style=\"color:#393A34\">(</span>recall_<span class=\"token\" style=\"color:#393A34\">)</span>\n    <span class=\"token\" style=\"color:#0000ff\">else</span><span class=\"token\" style=\"color:#393A34\">:</span>\n        rec <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#36acaa\">None</span>\n    <span class=\"token\" style=\"color:#0000ff\">return</span> <span class=\"token\" style=\"color:#393A34\">[</span>acc<span class=\"token\" style=\"color:#393A34\">,</span> prec<span class=\"token\" style=\"color:#393A34\">,</span> rec<span class=\"token\" style=\"color:#393A34\">]</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><h2>Train, Validate, Save</h2></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><p>Here we use something that is not necessarily k-fold cross validation. Our dataset is small, and randomized in the negative sampling process. What we do is run the trial multiple times and average the results. It is similar to k-fold cross validation but our dataset changes each time.</p></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[24]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\">labels_dfs <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">]</span>\n<span class=\"token\" style=\"color:#0000ff\">for</span> label <span class=\"token\" style=\"color:#0000ff\">in</span> final_labels<span class=\"token\" style=\"color:#393A34\">:</span>\n    data <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">]</span>\n    <span class=\"token\" style=\"color:#0000ff\">for</span> i <span class=\"token\" style=\"color:#0000ff\">in</span> <span class=\"token builtin\">range</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">5</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span>\n        x<span class=\"token\" style=\"color:#393A34\">,</span> y <span class=\"token\" style=\"color:#393A34\">=</span> get_subdataset<span class=\"token\" style=\"color:#393A34\">(</span>label<span class=\"token\" style=\"color:#393A34\">)</span>\n        x_train<span class=\"token\" style=\"color:#393A34\">,</span> x_test<span class=\"token\" style=\"color:#393A34\">,</span> y_train<span class=\"token\" style=\"color:#393A34\">,</span> y_test <span class=\"token\" style=\"color:#393A34\">=</span> train_test_split<span class=\"token\" style=\"color:#393A34\">(</span>x<span class=\"token\" style=\"color:#393A34\">,</span> y<span class=\"token\" style=\"color:#393A34\">,</span> train_size<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">0.8</span><span class=\"token\" style=\"color:#393A34\">)</span>\n        stats <span class=\"token\" style=\"color:#393A34\">=</span> predict_label<span class=\"token\" style=\"color:#393A34\">(</span>x_train<span class=\"token\" style=\"color:#393A34\">,</span> y_train<span class=\"token\" style=\"color:#393A34\">,</span> x_test<span class=\"token\" style=\"color:#393A34\">,</span> y_test<span class=\"token\" style=\"color:#393A34\">,</span> model_class<span class=\"token\" style=\"color:#393A34\">=</span>SVM<span class=\"token\" style=\"color:#393A34\">)</span>\n        stats<span class=\"token\" style=\"color:#393A34\">.</span>append<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;svm&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span>\n        data<span class=\"token\" style=\"color:#393A34\">.</span>append<span class=\"token\" style=\"color:#393A34\">(</span>stats<span class=\"token\" style=\"color:#393A34\">)</span>\n        stats <span class=\"token\" style=\"color:#393A34\">=</span> predict_label<span class=\"token\" style=\"color:#393A34\">(</span>x_train<span class=\"token\" style=\"color:#393A34\">,</span> y_train<span class=\"token\" style=\"color:#393A34\">,</span> x_test<span class=\"token\" style=\"color:#393A34\">,</span> y_test<span class=\"token\" style=\"color:#393A34\">,</span> model_class<span class=\"token\" style=\"color:#393A34\">=</span>FtModel<span class=\"token\" style=\"color:#393A34\">)</span>\n        stats<span class=\"token\" style=\"color:#393A34\">.</span>append<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;ft&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span>\n        data<span class=\"token\" style=\"color:#393A34\">.</span>append<span class=\"token\" style=\"color:#393A34\">(</span>stats<span class=\"token\" style=\"color:#393A34\">)</span>\n        n <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span>x<span class=\"token\" style=\"color:#393A34\">)</span>\n    stats_df <span class=\"token\" style=\"color:#393A34\">=</span> pd<span class=\"token\" style=\"color:#393A34\">.</span>DataFrame<span class=\"token\" style=\"color:#393A34\">(</span>data<span class=\"token\" style=\"color:#393A34\">,</span> columns <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;accuracy&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&#x27;precision&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&#x27;recall&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&#x27;model&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">)</span>\n    stats_df <span class=\"token\" style=\"color:#393A34\">=</span> stats_df<span class=\"token\" style=\"color:#393A34\">.</span>groupby<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;model&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span>mean<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span>reset_index<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span>\n    stats_df <span class=\"token\" style=\"color:#393A34\">=</span> stats_df<span class=\"token\" style=\"color:#393A34\">.</span>sort_values<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;accuracy&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> ascending <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#36acaa\">False</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span>iloc<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">]</span>\n    stats_df<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;n&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span> <span class=\"token\" style=\"color:#393A34\">=</span> n\n    stats_df<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;label&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span> <span class=\"token\" style=\"color:#393A34\">=</span> label\n    labels_dfs<span class=\"token\" style=\"color:#393A34\">.</span>append<span class=\"token\" style=\"color:#393A34\">(</span>stats_df<span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[25]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># save and print the validation results</span>\n\nresults_df <span class=\"token\" style=\"color:#393A34\">=</span> pd<span class=\"token\" style=\"color:#393A34\">.</span>DataFrame<span class=\"token\" style=\"color:#393A34\">(</span>labels_dfs<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span>sort_values<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;n&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span> ascending<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">False</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span>reset_index<span class=\"token\" style=\"color:#393A34\">(</span>drop <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#36acaa\">True</span><span class=\"token\" style=\"color:#393A34\">)</span>\n\nresults_df</code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><div><div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>model</th>\n      <th>accuracy</th>\n      <th>precision</th>\n      <th>recall</th>\n      <th>n</th>\n      <th>label</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>ft</td>\n      <td>0.622193</td>\n      <td>0.601722</td>\n      <td>0.761098</td>\n      <td>3736</td>\n      <td>kind/bug</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>svm</td>\n      <td>0.833641</td>\n      <td>0.800029</td>\n      <td>0.888497</td>\n      <td>2170</td>\n      <td>kind/test-flake</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>ft</td>\n      <td>0.718286</td>\n      <td>0.752696</td>\n      <td>0.646347</td>\n      <td>1746</td>\n      <td>component/cli</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>ft</td>\n      <td>0.702000</td>\n      <td>0.763575</td>\n      <td>0.593208</td>\n      <td>1496</td>\n      <td>kind/question</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>ft</td>\n      <td>0.710687</td>\n      <td>0.725599</td>\n      <td>0.649740</td>\n      <td>1310</td>\n      <td>area/usability</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>svm</td>\n      <td>0.800769</td>\n      <td>0.860276</td>\n      <td>0.733450</td>\n      <td>1296</td>\n      <td>component/build</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>svm</td>\n      <td>0.867451</td>\n      <td>0.910947</td>\n      <td>0.820620</td>\n      <td>1274</td>\n      <td>component/web</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>svm</td>\n      <td>0.760833</td>\n      <td>0.800040</td>\n      <td>0.712725</td>\n      <td>1198</td>\n      <td>area/tests</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>svm</td>\n      <td>0.819588</td>\n      <td>0.860887</td>\n      <td>0.749045</td>\n      <td>970</td>\n      <td>component/apps</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>svm</td>\n      <td>0.638217</td>\n      <td>0.627660</td>\n      <td>0.659721</td>\n      <td>782</td>\n      <td>component/kubernetes</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>svm</td>\n      <td>0.709231</td>\n      <td>0.789570</td>\n      <td>0.558110</td>\n      <td>648</td>\n      <td>component/imageregistry</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>svm</td>\n      <td>0.700000</td>\n      <td>0.691172</td>\n      <td>0.674546</td>\n      <td>646</td>\n      <td>component/networking</td>\n    </tr>\n    <tr>\n      <th>12</th>\n      <td>svm</td>\n      <td>0.670000</td>\n      <td>0.727195</td>\n      <td>0.609676</td>\n      <td>596</td>\n      <td>component/auth</td>\n    </tr>\n    <tr>\n      <th>13</th>\n      <td>svm</td>\n      <td>0.605000</td>\n      <td>0.606221</td>\n      <td>0.538003</td>\n      <td>596</td>\n      <td>sig/master</td>\n    </tr>\n    <tr>\n      <th>14</th>\n      <td>svm</td>\n      <td>0.818644</td>\n      <td>0.781162</td>\n      <td>0.871778</td>\n      <td>588</td>\n      <td>area/techdebt</td>\n    </tr>\n    <tr>\n      <th>15</th>\n      <td>svm</td>\n      <td>0.732653</td>\n      <td>0.838641</td>\n      <td>0.572921</td>\n      <td>490</td>\n      <td>component/routing</td>\n    </tr>\n    <tr>\n      <th>16</th>\n      <td>svm</td>\n      <td>0.685714</td>\n      <td>0.725969</td>\n      <td>0.653703</td>\n      <td>416</td>\n      <td>component/restapi</td>\n    </tr>\n    <tr>\n      <th>17</th>\n      <td>svm</td>\n      <td>0.701266</td>\n      <td>0.763196</td>\n      <td>0.601252</td>\n      <td>394</td>\n      <td>area/security</td>\n    </tr>\n    <tr>\n      <th>18</th>\n      <td>svm</td>\n      <td>0.666667</td>\n      <td>0.752119</td>\n      <td>0.548678</td>\n      <td>374</td>\n      <td>component/storage</td>\n    </tr>\n    <tr>\n      <th>19</th>\n      <td>svm</td>\n      <td>0.760000</td>\n      <td>0.720948</td>\n      <td>0.836848</td>\n      <td>346</td>\n      <td>component/internal-tools</td>\n    </tr>\n    <tr>\n      <th>20</th>\n      <td>svm</td>\n      <td>0.720588</td>\n      <td>0.740470</td>\n      <td>0.632601</td>\n      <td>338</td>\n      <td>component/install</td>\n    </tr>\n    <tr>\n      <th>21</th>\n      <td>svm</td>\n      <td>0.730303</td>\n      <td>0.754377</td>\n      <td>0.677270</td>\n      <td>326</td>\n      <td>sig/developer-experience</td>\n    </tr>\n    <tr>\n      <th>22</th>\n      <td>svm</td>\n      <td>0.774194</td>\n      <td>0.833404</td>\n      <td>0.738610</td>\n      <td>306</td>\n      <td>kind/post-rebase</td>\n    </tr>\n    <tr>\n      <th>23</th>\n      <td>svm</td>\n      <td>0.741379</td>\n      <td>0.794342</td>\n      <td>0.665123</td>\n      <td>290</td>\n      <td>component/composition</td>\n    </tr>\n    <tr>\n      <th>24</th>\n      <td>svm</td>\n      <td>0.700000</td>\n      <td>0.740478</td>\n      <td>0.617171</td>\n      <td>270</td>\n      <td>component/image</td>\n    </tr>\n    <tr>\n      <th>25</th>\n      <td>svm</td>\n      <td>0.728000</td>\n      <td>0.754704</td>\n      <td>0.655914</td>\n      <td>250</td>\n      <td>sig/security</td>\n    </tr>\n    <tr>\n      <th>26</th>\n      <td>svm</td>\n      <td>0.712500</td>\n      <td>0.721408</td>\n      <td>0.671072</td>\n      <td>236</td>\n      <td>sig/networking</td>\n    </tr>\n    <tr>\n      <th>27</th>\n      <td>svm</td>\n      <td>0.821739</td>\n      <td>0.847409</td>\n      <td>0.789917</td>\n      <td>228</td>\n      <td>area/documentation</td>\n    </tr>\n    <tr>\n      <th>28</th>\n      <td>svm</td>\n      <td>0.809756</td>\n      <td>0.818056</td>\n      <td>0.766739</td>\n      <td>202</td>\n      <td>component/cluster-up</td>\n    </tr>\n    <tr>\n      <th>29</th>\n      <td>svm</td>\n      <td>0.746341</td>\n      <td>0.691635</td>\n      <td>0.831349</td>\n      <td>202</td>\n      <td>area/performance</td>\n    </tr>\n    <tr>\n      <th>30</th>\n      <td>svm</td>\n      <td>0.805882</td>\n      <td>0.804860</td>\n      <td>0.819375</td>\n      <td>166</td>\n      <td>area/infrastructure</td>\n    </tr>\n    <tr>\n      <th>31</th>\n      <td>svm</td>\n      <td>0.886667</td>\n      <td>0.917483</td>\n      <td>0.836987</td>\n      <td>150</td>\n      <td>component/logging</td>\n    </tr>\n    <tr>\n      <th>32</th>\n      <td>svm</td>\n      <td>0.757143</td>\n      <td>0.753053</td>\n      <td>0.694335</td>\n      <td>138</td>\n      <td>sig/pod</td>\n    </tr>\n    <tr>\n      <th>33</th>\n      <td>svm</td>\n      <td>0.622222</td>\n      <td>0.620669</td>\n      <td>0.706081</td>\n      <td>134</td>\n      <td>help wanted</td>\n    </tr>\n    <tr>\n      <th>34</th>\n      <td>svm</td>\n      <td>0.762963</td>\n      <td>0.837115</td>\n      <td>0.720224</td>\n      <td>132</td>\n      <td>sig/storage</td>\n    </tr>\n    <tr>\n      <th>35</th>\n      <td>svm</td>\n      <td>0.907692</td>\n      <td>1.000000</td>\n      <td>0.810816</td>\n      <td>130</td>\n      <td>component/metrics</td>\n    </tr>\n    <tr>\n      <th>36</th>\n      <td>svm</td>\n      <td>0.672727</td>\n      <td>0.720556</td>\n      <td>0.704274</td>\n      <td>110</td>\n      <td>kind/feature</td>\n    </tr>\n    <tr>\n      <th>37</th>\n      <td>svm</td>\n      <td>0.742857</td>\n      <td>0.782098</td>\n      <td>0.693636</td>\n      <td>104</td>\n      <td>component/containers</td>\n    </tr>\n  </tbody>\n</table>\n</div></div></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><p>We can set conditions for saving the model below.</p></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[26]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># set conditions for saving the model of a potential label</span>\n\nmin_accuracy <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#36acaa\">0.75</span>\n\nmin_precision <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#36acaa\">0.75</span>\n\nmin_recall <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#36acaa\">0.0</span>\n\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># add in the labels you want to have a model for anyway</span>\n\naddins <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&quot;kind/bug&quot;</span><span class=\"token\" style=\"color:#393A34\">]</span>\n\ncondition1 <span class=\"token\" style=\"color:#393A34\">=</span> results_df<span class=\"token\" style=\"color:#393A34\">.</span>accuracy <span class=\"token\" style=\"color:#393A34\">&gt;</span> min_accuracy\ncondition2 <span class=\"token\" style=\"color:#393A34\">=</span> results_df<span class=\"token\" style=\"color:#393A34\">.</span>precision <span class=\"token\" style=\"color:#393A34\">&gt;</span> min_precision\ncond <span class=\"token\" style=\"color:#393A34\">=</span> condition1 <span class=\"token\" style=\"color:#393A34\">&amp;</span> condition2\n\nto_save <span class=\"token\" style=\"color:#393A34\">=</span> results_df<span class=\"token\" style=\"color:#393A34\">[</span>cond <span class=\"token\" style=\"color:#393A34\">|</span> results_df<span class=\"token\" style=\"color:#393A34\">.</span>label<span class=\"token\" style=\"color:#393A34\">.</span>isin<span class=\"token\" style=\"color:#393A34\">(</span>addins<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">]</span>\n\nlabels_to_save <span class=\"token\" style=\"color:#393A34\">=</span> to_save<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&quot;label&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&quot;model&quot;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>values\n\nto_save</code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><div><div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>model</th>\n      <th>accuracy</th>\n      <th>precision</th>\n      <th>recall</th>\n      <th>n</th>\n      <th>label</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>ft</td>\n      <td>0.622193</td>\n      <td>0.601722</td>\n      <td>0.761098</td>\n      <td>3736</td>\n      <td>kind/bug</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>svm</td>\n      <td>0.833641</td>\n      <td>0.800029</td>\n      <td>0.888497</td>\n      <td>2170</td>\n      <td>kind/test-flake</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>svm</td>\n      <td>0.800769</td>\n      <td>0.860276</td>\n      <td>0.733450</td>\n      <td>1296</td>\n      <td>component/build</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>svm</td>\n      <td>0.867451</td>\n      <td>0.910947</td>\n      <td>0.820620</td>\n      <td>1274</td>\n      <td>component/web</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>svm</td>\n      <td>0.760833</td>\n      <td>0.800040</td>\n      <td>0.712725</td>\n      <td>1198</td>\n      <td>area/tests</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>svm</td>\n      <td>0.819588</td>\n      <td>0.860887</td>\n      <td>0.749045</td>\n      <td>970</td>\n      <td>component/apps</td>\n    </tr>\n    <tr>\n      <th>14</th>\n      <td>svm</td>\n      <td>0.818644</td>\n      <td>0.781162</td>\n      <td>0.871778</td>\n      <td>588</td>\n      <td>area/techdebt</td>\n    </tr>\n    <tr>\n      <th>22</th>\n      <td>svm</td>\n      <td>0.774194</td>\n      <td>0.833404</td>\n      <td>0.738610</td>\n      <td>306</td>\n      <td>kind/post-rebase</td>\n    </tr>\n    <tr>\n      <th>27</th>\n      <td>svm</td>\n      <td>0.821739</td>\n      <td>0.847409</td>\n      <td>0.789917</td>\n      <td>228</td>\n      <td>area/documentation</td>\n    </tr>\n    <tr>\n      <th>28</th>\n      <td>svm</td>\n      <td>0.809756</td>\n      <td>0.818056</td>\n      <td>0.766739</td>\n      <td>202</td>\n      <td>component/cluster-up</td>\n    </tr>\n    <tr>\n      <th>30</th>\n      <td>svm</td>\n      <td>0.805882</td>\n      <td>0.804860</td>\n      <td>0.819375</td>\n      <td>166</td>\n      <td>area/infrastructure</td>\n    </tr>\n    <tr>\n      <th>31</th>\n      <td>svm</td>\n      <td>0.886667</td>\n      <td>0.917483</td>\n      <td>0.836987</td>\n      <td>150</td>\n      <td>component/logging</td>\n    </tr>\n    <tr>\n      <th>32</th>\n      <td>svm</td>\n      <td>0.757143</td>\n      <td>0.753053</td>\n      <td>0.694335</td>\n      <td>138</td>\n      <td>sig/pod</td>\n    </tr>\n    <tr>\n      <th>34</th>\n      <td>svm</td>\n      <td>0.762963</td>\n      <td>0.837115</td>\n      <td>0.720224</td>\n      <td>132</td>\n      <td>sig/storage</td>\n    </tr>\n    <tr>\n      <th>35</th>\n      <td>svm</td>\n      <td>0.907692</td>\n      <td>1.000000</td>\n      <td>0.810816</td>\n      <td>130</td>\n      <td>component/metrics</td>\n    </tr>\n  </tbody>\n</table>\n</div></div></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><p>For each label we want to save, we train the model again before saving but on the entire set of positive samples.</p></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[28]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#0000ff\">if</span> <span class=\"token\" style=\"color:#0000ff\">not</span> os<span class=\"token\" style=\"color:#393A34\">.</span>path<span class=\"token\" style=\"color:#393A34\">.</span>exists<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;./saved_models&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span>\n    os<span class=\"token\" style=\"color:#393A34\">.</span>mkdir<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;./saved_models&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span>\n\n<span class=\"token\" style=\"color:#0000ff\">if</span> <span class=\"token\" style=\"color:#0000ff\">not</span> os<span class=\"token\" style=\"color:#393A34\">.</span>path<span class=\"token\" style=\"color:#393A34\">.</span>exists<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token string-interpolation\"><span class=\"token\" style=\"color:#A31515\">f&quot;./saved_models/</span><span class=\"token interpolation\"><span class=\"token\" style=\"color:#393A34\">{</span>savename<span class=\"token\" style=\"color:#393A34\">}</span></span><span class=\"token\" style=\"color:#A31515\">&quot;</span></span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span>\n    os<span class=\"token\" style=\"color:#393A34\">.</span>mkdir<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token string-interpolation\"><span class=\"token\" style=\"color:#A31515\">f&quot;./saved_models/</span><span class=\"token interpolation\"><span class=\"token\" style=\"color:#393A34\">{</span>savename<span class=\"token\" style=\"color:#393A34\">}</span></span><span class=\"token\" style=\"color:#A31515\">&quot;</span></span><span class=\"token\" style=\"color:#393A34\">)</span>\n\nmodel_dic <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&quot;svm&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> SVM<span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&quot;ft&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> FtModel<span class=\"token\" style=\"color:#393A34\">}</span>\n\n<span class=\"token\" style=\"color:#0000ff\">if</span> use_ceph<span class=\"token\" style=\"color:#393A34\">:</span>\n    <span class=\"token\" style=\"color:#0000ff\">for</span> label<span class=\"token\" style=\"color:#393A34\">,</span> mod <span class=\"token\" style=\"color:#0000ff\">in</span> labels_to_save<span class=\"token\" style=\"color:#393A34\">:</span>\n        X<span class=\"token\" style=\"color:#393A34\">,</span> y <span class=\"token\" style=\"color:#393A34\">=</span> get_subdataset<span class=\"token\" style=\"color:#393A34\">(</span>label<span class=\"token\" style=\"color:#393A34\">)</span>\n        model <span class=\"token\" style=\"color:#393A34\">=</span> model_dic<span class=\"token\" style=\"color:#393A34\">[</span>mod<span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span>\n        model<span class=\"token\" style=\"color:#393A34\">.</span>fit<span class=\"token\" style=\"color:#393A34\">(</span>X<span class=\"token\" style=\"color:#393A34\">,</span> y<span class=\"token\" style=\"color:#393A34\">)</span>\n        lbl_path <span class=\"token\" style=\"color:#393A34\">=</span> os<span class=\"token\" style=\"color:#393A34\">.</span>path<span class=\"token\" style=\"color:#393A34\">.</span>join<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;saved_models&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span> label<span class=\"token\" style=\"color:#393A34\">.</span>replace<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;/&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&quot;_&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span>\n        lbl_path <span class=\"token\" style=\"color:#393A34\">+=</span> <span class=\"token\" style=\"color:#A31515\">&quot;.bin&quot;</span> <span class=\"token\" style=\"color:#0000ff\">if</span> mod <span class=\"token\" style=\"color:#393A34\">==</span> <span class=\"token\" style=\"color:#A31515\">&quot;ft&quot;</span> <span class=\"token\" style=\"color:#0000ff\">else</span> <span class=\"token\" style=\"color:#A31515\">&quot;.joblib&quot;</span>\n        model<span class=\"token\" style=\"color:#393A34\">.</span>save<span class=\"token\" style=\"color:#393A34\">(</span>lbl_path<span class=\"token\" style=\"color:#393A34\">)</span>\n        key <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token string-interpolation\"><span class=\"token\" style=\"color:#A31515\">f&quot;github-labeler/</span><span class=\"token interpolation\"><span class=\"token\" style=\"color:#393A34\">{</span>savename<span class=\"token\" style=\"color:#393A34\">}</span></span><span class=\"token\" style=\"color:#A31515\">/</span><span class=\"token interpolation\"><span class=\"token\" style=\"color:#393A34\">{</span>lbl_path<span class=\"token\" style=\"color:#393A34\">}</span></span><span class=\"token\" style=\"color:#A31515\">&quot;</span></span>\n        s3<span class=\"token\" style=\"color:#393A34\">.</span>upload_file<span class=\"token\" style=\"color:#393A34\">(</span>Bucket<span class=\"token\" style=\"color:#393A34\">=</span>s3_bucket<span class=\"token\" style=\"color:#393A34\">,</span> Key<span class=\"token\" style=\"color:#393A34\">=</span>key<span class=\"token\" style=\"color:#393A34\">,</span> Filename<span class=\"token\" style=\"color:#393A34\">=</span>lbl_path<span class=\"token\" style=\"color:#393A34\">)</span>\n        os<span class=\"token\" style=\"color:#393A34\">.</span>remove<span class=\"token\" style=\"color:#393A34\">(</span>lbl_path<span class=\"token\" style=\"color:#393A34\">)</span>\n<span class=\"token\" style=\"color:#0000ff\">else</span><span class=\"token\" style=\"color:#393A34\">:</span>\n    <span class=\"token\" style=\"color:#0000ff\">for</span> label <span class=\"token\" style=\"color:#0000ff\">in</span> labels_to_save<span class=\"token\" style=\"color:#393A34\">:</span>\n        X<span class=\"token\" style=\"color:#393A34\">,</span> y <span class=\"token\" style=\"color:#393A34\">=</span> get_subdataset<span class=\"token\" style=\"color:#393A34\">(</span>label<span class=\"token\" style=\"color:#393A34\">)</span>\n        model <span class=\"token\" style=\"color:#393A34\">=</span> model_dic<span class=\"token\" style=\"color:#393A34\">[</span>model<span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span>\n        model<span class=\"token\" style=\"color:#393A34\">.</span>fit<span class=\"token\" style=\"color:#393A34\">(</span>X<span class=\"token\" style=\"color:#393A34\">,</span> y<span class=\"token\" style=\"color:#393A34\">)</span>\n        lbl_path <span class=\"token\" style=\"color:#393A34\">=</span> os<span class=\"token\" style=\"color:#393A34\">.</span>path<span class=\"token\" style=\"color:#393A34\">.</span>join<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;saved_models&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span> label<span class=\"token\" style=\"color:#393A34\">.</span>replace<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;/&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&quot;_&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span>\n        lbl_path <span class=\"token\" style=\"color:#393A34\">+=</span> <span class=\"token\" style=\"color:#A31515\">&quot;.bin&quot;</span> <span class=\"token\" style=\"color:#0000ff\">if</span> model <span class=\"token\" style=\"color:#393A34\">==</span> <span class=\"token\" style=\"color:#A31515\">&quot;ft&quot;</span> <span class=\"token\" style=\"color:#0000ff\">else</span> <span class=\"token\" style=\"color:#A31515\">&quot;.joblib&quot;</span>\n        model<span class=\"token\" style=\"color:#393A34\">.</span>save<span class=\"token\" style=\"color:#393A34\">(</span>lbl_path<span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[29]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># save information of who to ignore (so the app knows not to tag these issues)</span>\n\n<span class=\"token\" style=\"color:#0000ff\">with</span> <span class=\"token builtin\">open</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;botlist.txt&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&quot;w&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span> <span class=\"token\" style=\"color:#0000ff\">as</span> f<span class=\"token\" style=\"color:#393A34\">:</span>\n    <span class=\"token\" style=\"color:#0000ff\">for</span> b <span class=\"token\" style=\"color:#0000ff\">in</span> bots<span class=\"token\" style=\"color:#393A34\">:</span>\n        f<span class=\"token\" style=\"color:#393A34\">.</span>write<span class=\"token\" style=\"color:#393A34\">(</span>b<span class=\"token\" style=\"color:#393A34\">)</span>\n        f<span class=\"token\" style=\"color:#393A34\">.</span>write<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;\\n&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span>\n\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># save label names</span>\n\n<span class=\"token\" style=\"color:#0000ff\">with</span> <span class=\"token builtin\">open</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;labellist.txt&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&quot;w&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span> <span class=\"token\" style=\"color:#0000ff\">as</span> f<span class=\"token\" style=\"color:#393A34\">:</span>\n    <span class=\"token\" style=\"color:#0000ff\">for</span> label<span class=\"token\" style=\"color:#393A34\">,</span> model <span class=\"token\" style=\"color:#0000ff\">in</span> labels_to_save<span class=\"token\" style=\"color:#393A34\">:</span>\n        f<span class=\"token\" style=\"color:#393A34\">.</span>write<span class=\"token\" style=\"color:#393A34\">(</span>label <span class=\"token\" style=\"color:#393A34\">+</span> <span class=\"token\" style=\"color:#A31515\">&quot;\\t&quot;</span> <span class=\"token\" style=\"color:#393A34\">+</span> model<span class=\"token\" style=\"color:#393A34\">)</span>\n        f<span class=\"token\" style=\"color:#393A34\">.</span>write<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;\\n&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span>\n\n<span class=\"token\" style=\"color:#0000ff\">if</span> use_ceph<span class=\"token\" style=\"color:#393A34\">:</span>\n    s3<span class=\"token\" style=\"color:#393A34\">.</span>upload_file<span class=\"token\" style=\"color:#393A34\">(</span>\n        Bucket<span class=\"token\" style=\"color:#393A34\">=</span>s3_bucket<span class=\"token\" style=\"color:#393A34\">,</span>\n        Key<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token string-interpolation\"><span class=\"token\" style=\"color:#A31515\">f&quot;github-labeler/</span><span class=\"token interpolation\"><span class=\"token\" style=\"color:#393A34\">{</span>savename<span class=\"token\" style=\"color:#393A34\">}</span></span><span class=\"token\" style=\"color:#A31515\">/botlist.txt&quot;</span></span><span class=\"token\" style=\"color:#393A34\">,</span>\n        Filename<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&quot;botlist.txt&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#393A34\">)</span>\n    s3<span class=\"token\" style=\"color:#393A34\">.</span>upload_file<span class=\"token\" style=\"color:#393A34\">(</span>\n        Bucket<span class=\"token\" style=\"color:#393A34\">=</span>s3_bucket<span class=\"token\" style=\"color:#393A34\">,</span>\n        Key<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token string-interpolation\"><span class=\"token\" style=\"color:#A31515\">f&quot;github-labeler/</span><span class=\"token interpolation\"><span class=\"token\" style=\"color:#393A34\">{</span>savename<span class=\"token\" style=\"color:#393A34\">}</span></span><span class=\"token\" style=\"color:#A31515\">/labellist.txt&quot;</span></span><span class=\"token\" style=\"color:#393A34\">,</span>\n        Filename<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&quot;labellist.txt&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div></div></div>","fields":{"srcLink":"https://github.com/aicoe-aiops/github-labeler/blob/master/models/train_models.ipynb"}}},"pageContext":{"id":"0957a9ac-7f88-536d-9c54-139c961ee016 >>> JupyterNotebook"}},"staticQueryHashes":["1764348645","2823140819","3000541721","3606484676"]}